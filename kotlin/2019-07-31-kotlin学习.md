---
layout:     post  
title:      kotlinå­¦ä¹  
subtitle:   kotlin
date:       2019-07-31
author:     å°å·å­
header-img: img/tag-bg.jpg
catalog: true
tags:
    - æ ‡ç­¾
---



[TOC]



##æ•°æ®ç±»å‹

### stringçš„æ¯”è¾ƒ,== å’Œequals()

javaæ¯”è¾ƒå­—ç¬¦ä¸²çš„å†…å­˜åœ°å€ç”¨==ï¼Œkotlinç”¨===

kotlinä¸­çš„== å’Œequals()æ˜¯å®Œå…¨ç›¸åŒçš„

~~~java
s1 == s2;//ç›¸å½“äºjavaä¸­çš„equals()
s1 === s2;//ç›¸å½“äºjavaä¸­çš„==
~~~



### å­—ç¬¦ä¸²æ¨¡æ¿

å¯ä»¥åœ¨ä»£ç ä¸­å£°æ˜ä¸€ä¸ªå˜é‡ï¼Œåœ¨å˜é‡å‰ç”¨$ä¿®é¥°ï¼Œå°±å˜æˆäº†ç›´æ¥å¼•ç”¨è¯¥å¯¹è±¡ï¼Œå¦‚æœå¯¹è±¡è¿˜è¦è°ƒç”¨å…¶å±æ€§éœ€è¦åŠ ä¸Šå°æ‹¬å·

~~~kotlin
val a = 10
val s = "a = $a" //æ‰“å°ç»“æœä¸ºa = 10

val s = "Hello World"
println("s.length=${s.length}")
~~~



### varã€valå’Œconst

**varï¼š** varæ˜¯ä¸€ä¸ªå¯å˜å˜é‡ï¼Œè¿™æ˜¯ä¸€ä¸ªå¯ä»¥é€šè¿‡é‡æ–°åˆ†é…æ¥æ›´æ”¹ä¸ºå¦ä¸€ä¸ªå€¼çš„å˜é‡ã€‚è¿™ç§å£°æ˜å˜é‡çš„æ–¹å¼å’ŒJavaä¸­å£°æ˜å˜é‡çš„æ–¹å¼ä¸€æ ·ã€‚
**val:** valæ˜¯ä¸€ä¸ªåªè¯»å˜é‡ï¼Œè¿™ç§å£°æ˜å˜é‡çš„æ–¹å¼ç›¸å½“äºjavaä¸­çš„finalå˜é‡ã€‚ä¸€ä¸ªvalåˆ›å»ºçš„æ—¶å€™å¿…é¡»åˆå§‹åŒ–ï¼Œå› ä¸ºä»¥åä¸èƒ½è¢«æ”¹å˜ã€‚

ä¸€ä¸ª**var**çš„å˜é‡ä¼šå¯¹åº”ç”Ÿæˆä¸¤ä¸ªæ–¹æ³•,å³getterå’Œsetteræ–¹æ³•

è€Œ**val**åªä¼šç”Ÿæˆä¸€ä¸ªå¯¹åº”çš„getæ–¹æ³•

ç”Ÿæˆçš„å­—èŠ‚ç ä¼šåŒ…å«ç±»ä¼¼è¿™æ ·çš„æ–¹æ³•



ä½†æ˜¯valå¹¶ä¸ç­‰äºå¸¸é‡

é€šè¿‡valå®šä¹‰çš„å˜é‡ï¼Œåªæœ‰getæ–¹æ³•ï¼Œæ²¡æœ‰setæ–¹æ³•ï¼Œæ‰€ä»¥åªèƒ½è¯»ä¸èƒ½å†™ã€‚
ä½†æ˜¯å…¶getæ–¹æ³•å¯ä»¥å¤å†™ï¼Œä»è€Œé€ æˆvalå®šä¹‰çš„å˜é‡ï¼Œæœ‰å¯èƒ½ä¼šå‘ç”Ÿå€¼å˜åŒ–ï¼Œæƒ…å†µä¸‹é¢çš„ä¾‹å­ï¼š

~~~java
 val A : Int 
    get()  {
        val rand = Random(System.currentTimeMillis())
        return rand.nextInt()
    }
~~~

valå®šä¹‰çš„å¸¸é‡Açš„get()æ–¹æ³•è¢«å¤å†™ï¼Œæ¯æ¬¡è°ƒç”¨å¸¸é‡Aéƒ½ä¼šè¿”å›ä¸€ä¸ªéšæœºæ•°ï¼Œæ‰€ä»¥ä¸èƒ½ä¿è¯å¸¸é‡Açš„å€¼ä¸å˜ã€‚è¿™åªæ˜¯ä¸€ç§ç‰¹æ®Šå†™æ³•ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½å¯ä»¥å¯¹åº”javaä¸­çš„finalä½¿ç”¨ã€‚



**const**ä¿®é¥°çš„valå˜é‡ç›¸å½“äºjavaä¸­ `static final`æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„javaå¸¸é‡

constå…³é”®æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

- åªèƒ½ä¿®æ”¹valå¸¸é‡ã€‚
- constä¿®é¥°çš„å¸¸é‡å¿…é¡»å£°æ˜åœ¨å¯¹è±¡ï¼ˆåŒ…æ‹¬ä¼´ç”Ÿå¯¹è±¡ï¼‰æˆ–è€…ã€Œtop-level é¡¶å±‚ã€ä¸­ï¼Œå› ä¸ºå¸¸é‡æ˜¯é™æ€çš„

~~~java
const val userName: String = "yeqiu"
const val password: String = "yeqiu"
~~~



**Kotlin ä¸­åªæœ‰åŸºæœ¬ç±»å‹å’Œ String ç±»å‹å¯ä»¥å£°æ˜æˆå¸¸é‡**

Kotlin ä¸­çš„å¸¸é‡æŒ‡çš„æ˜¯ ã€Œcompile-time constant ç¼–è¯‘æ—¶å¸¸é‡ã€ï¼Œå®ƒçš„æ„æ€æ˜¯ã€Œç¼–è¯‘å™¨åœ¨ç¼–è¯‘çš„æ—¶å€™å°±çŸ¥é“è¿™ä¸ªä¸œè¥¿åœ¨æ¯ä¸ªè°ƒç”¨å¤„çš„å®é™…å€¼ã€ï¼Œå› æ­¤å¯ä»¥åœ¨ç¼–è¯‘æ—¶ç›´æ¥æŠŠè¿™ä¸ªå€¼ç¡¬ç¼–ç åˆ°ä»£ç é‡Œä½¿ç”¨çš„åœ°æ–¹ã€‚æ¯”å¦‚ä¸€ä¸ªjavaä¸­ä¸€ä¸ªuserå¯¹è±¡æ˜¯static finalã€‚ä½†æ˜¯ä¾ç„¶å¯ä»¥ä¿®æ”¹userä¸­çš„nameè¿™äº›å±æ€§ã€‚æ‰€ä»¥ Java ä¸­çš„å¸¸é‡å¯ä»¥è®¤ä¸ºæ˜¯ã€Œä¼ªå¸¸é‡ã€ï¼Œå› ä¸ºå¯ä»¥è¯»å–å€¼å¾—è¿™ç§æ–¹å¼æ”¹å˜å®ƒå†…éƒ¨çš„å€¼ã€‚è€Œ Kotlin çš„å¸¸é‡å› ä¸ºé™åˆ¶ç±»å‹å¿…é¡»æ˜¯åŸºæœ¬ç±»å‹ï¼Œæ‰€ä»¥ä¸å­˜åœ¨è¿™ç§é—®é¢˜ï¼Œæ›´ç¬¦åˆå¸¸é‡çš„å®šä¹‰ã€‚



### è½¬ä¹‰å­—ç¬¦

![](http://ww1.sinaimg.cn/large/006tNc79ly1g5j0063p8oj30fs09l0t4.jpg)





### â€â€œâ€ä¸‰ä¸ªå¼•å·

ä½¿ç”¨ä¸‰ä¸ªå¼•å·(""")åŒ…æ‹¬ï¼Œå†…éƒ¨æ²¡æœ‰è½¬ä¹‰ï¼Œå¯ä»¥åŒ…å«æ¢è¡Œå’Œä»»ä½•å…¶ä»–æ–‡æœ¬ã€‚æ‰€æœ‰è½¬ä¹‰åœ¨ä¸‰ä¸ªå¼•å·ä¸­éƒ½ä¼šå¤±æ•ˆ





### ç±»å’Œå¯¹è±¡

javaä¸­åˆ›å»ºç±»

~~~java
				public class Animal {
  
		    private int age;
 		  	private boolean sex;
        private String name;

        public Animal(int age, boolean sex, String name) {
            this.age = age;
            this.sex = sex;
            this.name = name;
      		  }
    		}
~~~

åˆ›å»ºä¸€ä¸ªcatç»§æ‰¿Animal

```java
				public class Cat extends Animal {

 				   public Cat(int age, boolean sex, String name) {
 				       super(age, sex, name);
				    }

				    public void eat(){
				        System.out.println("çŒ« è°ƒç”¨eat()");
				    }
    
				}
```

åœ¨ä½¿ç”¨ä¸Š

~~~java
   		 public static void main(String[] args) {
   		     Animal animal = new Cat(1,true,"cat");
   		     if (animal instanceof Cat){
 		           Cat cat= (Cat) animal;
 		           cat.eat();
		        }
		    }
~~~



è¿™æ˜¯ä¸€æ®µå¾ˆç®€å•çš„javaä»£ç ï¼Œåˆ›å»ºäº†Animalç±»ï¼Œåˆåˆ›å»ºCatç»§æ‰¿Animalï¼ŒCatä¸­æ–°åŠ äº†eat()æ–¹æ³•ï¼Œmain()ä¸­åˆ›å»ºäº†ä¸€ä¸ªCatå¹¶èµ‹å€¼ç»™äº†Animalï¼Œè¿™é‡Œæ˜¯çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»å¯¹è±¡ã€‚ç„¶ååˆæŠŠAnimalå¼ºè½¬æˆCatå¹¶è°ƒç”¨eat()æ–¹æ³•ã€‚



ä»¥ä¸‹æ˜¯kotlinçš„å®ç°æ–¹å¼

~~~java
				//kotliä¸­æ‰€æœ‰ç±»é»˜è®¤éƒ½æ˜¯final,å¯ä»¥ç”¨openè§£é™¤
				//constructoræ˜¯æ„é€ æ–¹æ³•
				//åˆ›å»ºå¯¹è±¡æ—¶é»˜è®¤æ‰§è¡Œ
				open class Person constructor(var name: String, var age: Int, var sex: String) {

				    init {
				        println("å§“åï¼š$name,å¹´é¾„ï¼š$age,æ€§åˆ«ï¼š$sex")
				    }
				}
~~~



~~~java
				class Coder(name: String, age: Int, sex: String) : Person(name, age, sex) {
 
 				   fun coding() {
 				       println("coding")
 				   }
				}
~~~

~~~java
				fun main(args: Array<String>) {

				    var person: Person = Coder("Android", 18, "ç”·");
				    //ç›¸å½“äºjavaçš„å¼ºè½¬ï¼Œå¦‚æœè½¬æ¢å¤±è´¥ä¼šæŠ›å‡ºå¼‚å¸¸
				    val coder = person as Coder
				    coder.coding()
				}
~~~





### nullå®‰å…¨

~~~java
				public String getName(){
     		   if (true){
       		     return "name";
      		  }else{
      		      return null;
      		  }
    		}
~~~

è¿™æ˜¯ä¸€æ®µå¾ˆå¸¸è§çš„javaä»£ç ï¼ŒgetNameè¿”å›ä¸€ä¸ªstringï¼Œä½†æ˜¯ä¹Ÿå¯èƒ½ä¼šè¿”å›nullã€‚æ‰€æœ‰åœ¨è°ƒç”¨çš„æ—¶å€™ä¸€èˆ¬éƒ½ä¼šåš*Nullcheck*

~~~java
				fun getName():String{
  				  if (true){
 				       return "name"
				    }else{
				        return null
 				   }
				}
~~~

ä»¥ä¸Šæ˜¯getName() kotlinçš„å†™æ³•ï¼Œä½†æ˜¯è¿™ä¹ˆå†™åœ¨ç¼–è¾‘å™¨ä¸­ä¼šæŠ¥é”™ã€‚å› ä¸ºæ–¹æ³•è¿”å›ä¸€ä¸ªstringä¸èƒ½ä¸ºnullï¼Œä¿®æ”¹ä¸º

~~~java
				fun getName(): String? {
				    if (true){
        				return "name"
    				}else{
        				return null
				    }
				}
~~~

è¿™æ—¶å€™ç¼–è¯‘å°±æ²¡é—®é¢˜äº†ï¼Œä½†æ˜¯å’Œjavaçš„ä¸€æ ·éƒ½ä¼šæœ‰nullçš„é—®é¢˜ã€‚çœ‹çœ‹è¿™ç§å†™æ³•åœ¨ç”¨çš„æ—¶å€™ä¼šæœ‰ä»€ä¹ˆä¸ä¸€æ ·

![](http://ww1.sinaimg.cn/large/006tNc79ly1g5k6kvsv0sj30jy0h9dfy.jpg)

è¿™é‡Œå®šä¹‰äº†ä¸¤ä¸ªgetName()ï¼Œç¬¬ä¸€ä¸ªå¯èƒ½ä¼šè¿”å›nullï¼Œç¬¬äºŒä¸ªä¸ä¼šè¿”å›nullã€‚åœ¨mainæ–¹æ³•ä¸­è°ƒç”¨ã€‚å¯ä»¥çœ‹åˆ°ç¬¬ä¸€ä¸ªåœ¨`println(name.length)`çš„æ—¶å€™æŠ¥é”™äº†ã€‚é”™è¯¯å¦‚ä¸‹å›¾;

![](http://ww1.sinaimg.cn/large/006tNc79ly1g5k6mfx9y6j30hh01ujr8.jpg)

å¤§æ¦‚çš„æ„æ€å°±æ˜¯nameè¿™ä¸ªå€¼å¯èƒ½ä¼šæ˜¯nullï¼Œç”¨çš„æ—¶å€™è¦åšåˆ¤æ–­ã€‚æ”¹æˆè¿™æ ·

~~~java
				fun main() {
 				   val name = getName()
 				   val name2 = getName2()
 				   if (name!=null){
  				      println(name.length)
 				   }
 				   println(name2.length)
 				   //ä¸Šé¢ifä¸­çš„åˆ¤æ–­ä¹Ÿå¯ä»¥ç®€åŒ–æˆä¸‹é¢è¿™æ ·ï¼Œæ„æ€å°±æ˜¯å¦‚æœnameä¸æ˜¯nullå°±æ­£å¸¸æ‰§è¡Œå¦åˆ™ä¸æ‰§è¡Œåç»­æ“ä½œ
 				    println(name?.length)
      
				}
~~~



è¿˜æœ‰åœºæ™¯

~~~java
				String name = getName();
        if (name==null){
            return;
        }
~~~

è¿™æ®µä¹Ÿæ˜¯å¾ˆå¸¸è§çš„ï¼Œå¦‚æœnameæ˜¯nullç›´æ¥è¿”å›ï¼Œä¸åœ¨æ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚kontlinä¸­ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™ï¼Œä½†æ˜¯å†™å®Œä¹‹åç¼–è¾‘å™¨ä¼šæç¤ºä½ å¯ä»¥ç®€åŒ–æˆè¿™æ ·

~~~java
				//å¦‚æœnameæ˜¯nullç›´æ¥return
				val name = getName() ?: return;
~~~

å†çœ‹è¿™æ®µä»£ç 

![åŸè°…æˆ‘çš„åˆ†å·](http://ww3.sinaimg.cn/large/006tNc79ly1g5k6ynshhkj30f1056jr9.jpg)



è¿™é‡Œæ²¡æœ‰å¯¹nameå­—æ®µåšä»»ä½•énullçš„åˆ¤æ–­ï¼Œä½†æ˜¯åœ¨printlnä¸­å¹¶æ²¡æœ‰æŠ¥é”™ï¼Œå› ä¸ºä¸Šä¸€å¥ä»£ç ä¸­å·²ç»è¯´æ˜å¦‚æœnameæ˜¯nullçš„è¯å°±return(åŸè°…æˆ‘çš„åˆ†å·)



å¦ä¸€ç§æƒ…å†µ

![](http://ww1.sinaimg.cn/large/006tNc79ly1g5k7dm1e85j30ah02imwz.jpg)

è¿™é‡Œå£°æ˜äº†ä¸€ä¸ªå¯ä»¥ä¸ºnullçš„nameï¼Œé‚£åœ¨è°ƒç”¨çš„æ—¶å€™ç¼–è¯‘å™¨åˆä¼šæç¤º*Nullcheck*ï¼Œä½†æ˜¯æˆ‘çŸ¥é“è¿™é‡Œçš„nameä¸æ˜¯nullï¼Œå¯ä»¥æ¢æˆä¸‹é¢çš„å†™æ³•

~~~java
				fun main() {
				    var name:String? = "aaa";
				    println(name!!.length)
				}
~~~

åœ¨å˜é‡å‰ç”¨!!è¡¨ç¤ºå¯¹è±¡énullï¼Œå¦‚æœnameçœŸçš„æ˜¯nullçš„è¯åŒæ ·ä¹Ÿä¼šæŠ›å‡ºNullPointerExceptionï¼Œè¿™ä¸ªä¸€å®šè¦æ…ç”¨!!

~~~java
 		   //ä»»ä½•çš„å¯¹è±¡éƒ½å¯èƒ½å­˜åœ¨nullçš„æƒ…å†µ
 		  	val notNull: String = null;//ç¼–è¯‘å™¨æŠ¥é”™ï¼ŒnotNullå¯¹è±¡ä¸èƒ½ä¸ºnull
 		  	val nullable: String? = null;//æ­£ç¡®ï¼ŒString?è¡¨ç¤ºå¯ä»¥ä¸ºnull
 		   	notNull.length //æ­£ç¡®ï¼ŒnotNullå¯¹è±¡ä¸å¯èƒ½ä¸ºnullå¯ä»¥ç›´æ¥ä½¿ç”¨
  		  nullable.length //ç¼–è¯‘å™¨æŠ¥é”™ï¼Œnullableå¯¹è±¡å¯èƒ½ä¸ºnullå¿…é¡»å…ˆåšNullcheck
  		  nullable!!.length //æ­£ç¡® å¼€å‘è€…ç¡®è®¤nullableä¸ä¸ºnullï¼Œä½†æ˜¯ä»æœ‰ç©ºæŒ‡é’ˆé£é™©ï¼Œè¿™æ˜¯å¾ˆå±é™©çš„æ“ä½œ
  		  nullable?.length //æ­£ç¡® å¦‚æœnullableæ˜¯nullç›´æ¥ä¼šè¿”å›nullå¹¶ä¸è°ƒç”¨lengthæ–¹æ³•
~~~



æœ€åæ€»ç»“ä¸€ä¸‹ï¼Œå…¶å®åœ¨å®é™…å¼€å‘ä¸­nullæ˜¯ä¸å¯é¿å…çš„ã€‚åœ¨avaçš„ç¼–è¾‘å™¨æ„Ÿè§‰ä¸å¤Ÿé‡è§†NullPointerException,æˆ‘åˆšå·¥ä½œçš„æ—¶å€™è¢«nullæŠ˜ç£¨çš„è‹¦ä¸å ªè¨€ï¼Œç”šè‡³æ”¹è¿‡IDEç”Ÿæˆget()çš„æ¨¡æ¿æ¥è‡ªåŠ¨ç”Ÿæˆénullå¯¹è±¡ã€‚kotlinä¸­åŒæ ·æ— æ³•é¿å…nullï¼Œä½†æ˜¯å¼€å‘æ—¶ç¼–è¾‘å™¨ä¼šè‡ªåŠ¨æç¤ºnullçš„å®‰å…¨åˆ¤æ–­ï¼ŒåŒæ—¶ä¹Ÿç®€åŒ–äº†nullçš„åˆ¤æ–­ï¼ˆå†™æ³•ä¸Šæˆ‘è¿˜æ˜¯æ„Ÿè§‰æœ‰ç‚¹æ€ªï¼‰,ç¼–è¯‘å™¨ä¹Ÿå˜å¾—ååˆ†æ™ºèƒ½ã€‚å…¶å®è¿™å¹¶ä¸èƒ½å«nullå®‰å…¨ï¼Œåªæ˜¯ç¼–è¾‘å™¨å¼ºåˆ¶å¼€å‘è€…å¿…é¡»è¦åš*Nullcheck*ã€‚ï¼Ÿ

### å…³äºä½¿ç”¨ ? !!å®‰å…¨æ£€æµ‹æ“ä½œç¬¦

~~~java
    val s:String? = null
    s?.length
~~~

Stringç±»å‹çš„å˜é‡å¿…é¡»è¦èµ‹å€¼æ‰èƒ½ä½¿ç”¨ï¼Œç›´æ¥èµ‹å€¼ä¸ºnullä¹Ÿä¼šæŠ¥é”™ï¼Œå¿…é¡»åŠ ä¸Šï¼Ÿè¡¨ç¤ºè¿™ä¸ªstringæ˜¯å¯nullç±»å‹çš„ã€‚åœ¨è°ƒç”¨çš„æ—¶å€™ ç›´æ¥è°ƒç”¨IDEä¹Ÿä¼šæç¤ºså¯èƒ½ä¼šæ˜¯nullï¼ŒåŠ ä¸Šï¼Ÿè¡¨ç¤ºï¼Œå¦‚æœæ˜¯nullçš„è¯å°±ä¸æ‰§è¡Œã€‚`s?.length`ç›¸å½“äº

~~~java
        if (s!=null){
            s.length();
        }
~~~

å…¶å®nullçš„é—®é¢˜è¿˜æ˜¯æ²¡æœ‰è§£å†³ï¼Œåªæ˜¯è¿™é‡ŒIDEä¼šæç¤ºä½ æœ‰nullçš„é£é™©ã€‚å¦‚æœä½ å¾ˆè‡ªä¿¡å°±ç›´æ¥ï¼Ÿè·³è¿‡æ£€æµ‹ã€‚ä¸è¿‡ä¸€æ—¦æ˜¯nullçš„è¯è¿™å¥ä»£ç ä¸æ‰§è¡Œå¯èƒ½ä¼šå½±å“åç»­çš„æ•´ä¸ªé€»è¾‘ã€‚

!!è¿™ä¸ªç¬¦å·è¢«ç§°ä½œè­¦å‘Šè°ƒç”¨ç¬¦ï¼Œå…¶æ„ä¹‰æ˜¯ï¼šå¦‚æœè¿™å¯¹è±¡ä¸ºç©ºï¼Œç›´æ¥ç»ˆæ­¢ç¨‹åºï¼ŒæŠ›å‡ºNPEå¼‚å¸¸ã€‚å°±å’Œjavaä¸­ç›´æ¥ä½¿ç”¨nullå¯¹è±¡ä¸€æ ·ã€‚åªæ˜¯æ¶ˆé™¤çš„IDEçš„æç¤ºã€‚





### ç±»å‹è½¬æ¢

javaä¸­çš„å¼ºè½¬

~~~java
        //åˆ›å»ºcatå¹¶èµ‹å€¼ç»™animal
        Animal animal = new Cat(1,true,"å°çŒ«å’ª");
        //è°ƒç”¨catä¸­eatæ–¹æ³•,å¿…é¡»å…ˆè¿›è¡Œå¼ºè½¬
        if (animal instanceof Cat){
            //å¼ºè½¬æˆcat
            ((Cat) animal).eat();
        }
~~~

kotlin

```java
		var person :Person = Coder("Android",18,"ç”·");
		//is ç›¸å½“äºjavaä¸­çš„ instanceof
		if (person is Coder){
		    person.coding()
		}
```

å¯ä»¥çœ‹åˆ°éƒ½éœ€è¦åšå¼ºè½¬å‰çš„åˆ¤æ–­ï¼Œä½†æ˜¯kotlinåœ¨åˆ¤æ–­åå°±ä¸éœ€è¦åœ¨åšå¼ºè½¬çš„æ“ä½œã€‚ifæˆç«‹åç¼–è¯‘å™¨è®¤ä¸º`person == Coder`

å¦ä¸€ä¸ªåœºæ™¯

```java
		//è¿™é‡Œjavaä¼šç›´æ¥æŠ¥ç±»å‹è½¬æ¢å¼‚å¸¸
		Animal animal = new Animal(1,true,"å°çŒ«å’ª");
		((Cat) animal).eat();
```

kotlin

~~~java
		var person: Person = Person("Android", 18, "ç”·");
		(person as Coder).coding()
~~~

è¿™é‡Œå¼ºè½¬åŒæ ·ä¼šå¼‚å¸¸ï¼Œçœ‹å¦ä¸€ç§å†™æ³•

```java
		//è¿™é‡Œåœ¨å¼ºè½¬çš„æ—¶å€™ä½¿ç”¨äº†asï¼Ÿè¡¨ç¤ºå¦‚æœå¼ºè½¬å¤±è´¥å°†ä¼šç­‰åˆ°nullï¼Œé‚£åœ¨è°ƒç”¨codingæ–¹æ³•çš„æ—¶å€™åˆ¤æ–­ä¸ºnullåœæ­¢è°ƒç”¨
		var person: Person = Person("Android", 18, "ç”·");
		val coder: Coder? = person as? Coder
		coder?.coding()
```



### å…³äºï¼Ÿå’Œï¼ï¼

**"?"åŠ åœ¨å˜é‡ååï¼Œè¡¨ç¤ºè¿™ä¸ªå¯¹è±¡å¯ä»¥ä¸ºnullã€‚**
**"!!"åŠ åœ¨å˜é‡ååï¼Œè¡¨ç¤ºå¼ºåˆ¶è®¤ä¸ºå¯èƒ½ä¸ºnullçš„å¯¹è±¡ä¸€å®šä¸ä¸ºnullï¼Œå¦‚æœå¯¹è±¡ä¸ºnullï¼Œè°ƒç”¨ä¸€å®šä¼šæŠ¥å¼‚å¸¸ï¼**

**?**åˆ°åº•æ€ä¹ˆç”¨ã€‚
åœ¨å£°æ˜å¯¹è±¡æ—¶ï¼ŒæŠŠå®ƒè·Ÿåœ¨ç±»ååé¢ï¼Œè¡¨ç¤ºè¿™ä¸ªç±»å…è®¸ä¸ºnullï¼›
åœ¨è°ƒç”¨å¯¹è±¡æ—¶ï¼ŒæŠŠå®ƒè·Ÿåœ¨å¯¹è±¡åé¢ï¼Œè¡¨ç¤ºå¦‚æœä¸ºnullç¨‹åºç›´æ¥è¿”å›nullå¹¶ä¸ç»§ç»­è°ƒç”¨

~~~kotlin
    var coder: Coder? = null
    //å¦‚æœcoder == null,codingæ–¹æ³•ä¸ä¼šæ‰§è¡Œ
    coder?.coding()
    //å¦‚æœcoder == nullå¹¶ä¸å½±å“è¿™å¥ä»£ç 
    println(coder === null)
~~~



ç„¶è€ŒåŠ ä¸Šé—®å·ä»¥åç¨‹åºå°±ä¸‡äº‹å¤§å‰æ°¸è¿œæ‘†è„±äº†NullPointerExceptionçš„çƒ¦æ¼ï¼Ÿæˆ‘ä»¬å†çœ‹ä¸‹ä¸€æ®µä»£ç ï¼š

![](http://ww1.sinaimg.cn/large/006tNc79ly1g5k9jaus0kj30fh03g746.jpg)

æŠ¥é”™ä¿¡æ¯

![](http://ww1.sinaimg.cn/large/006tNc79ly1g5k9kas1w2j30mj01cdfo.jpg)

å¤§æ¦‚çš„æ„æ€æ˜¯ list?.size > 0å¯èƒ½ä¼šè¿”å›nullï¼Œnullæ— æ³•è·Ÿintè¿›è¡Œæ¯”è¾ƒï¼Œå»ºè®®æ”¹æˆ`list?.size!! > 0` 

å¥½ï¼Œä¸€æ—¦æ”¹æˆäº†è¿™æ ·è¿™é‡Œçš„listå°±æ˜¯nullé‚£è¿è¡Œåˆ°list?.sizeå¿…ç„¶ä¼šç©ºæŒ‡é’ˆã€‚çœ‹æ¥å¿…é¡»è¦åŠ ä¸Šif !=nullçš„åˆ¤æ–­ï¼Œ

~~~java
    		if (list!=null){
     		    if (list?.size > 0){
     		       println("listçš„é•¿åº¦ä¸æ˜¯0")
     		   } 
   		 }
~~~

ç„¶åè¿™æ ·å°±å’Œjavaä¸€æ ·ï¼Œæœ‰äº›å•°å—¦ã€‚å¯ä»¥ç®€åŒ–æˆä¸‹é¢è¿™æ ·

```java
				if (list?.size ?: 0 > 0) {
				    println("listçš„é•¿åº¦ä¸æ˜¯0")
				}
```

Kotlinæä¾›äº†`å¯¹è±¡A ?: å¯¹è±¡B`è¡¨è¾¾å¼ï¼Œå¹¶ä¸”å–æ¶ˆäº†Javaä¸­çš„`æ¡ä»¶è¡¨è¾¾å¼ ? è¡¨è¾¾å¼1 : è¡¨è¾¾å¼2`è¿™ä¸ªä¸‰å…ƒè¡¨è¾¾å¼ã€‚

?:è¡¨ç¤ºçš„æ„æ€æ˜¯ï¼Œå½“å¯¹è±¡Aå€¼ä¸ºnullçš„æ—¶å€™ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šè¿”å›åé¢çš„å¯¹è±¡Bã€‚

æ‹†å¼€æ¥çœ‹ä¸Šé¢çš„ä»£ç  list?.size ?: 0 > 0

```java
				val list: ArrayList<String>? = null
				val size = list?.size ?: 0//ä»…ä»…åœ¨å·¦è¾¹çš„è¡¨è¾¾å¼ç»“æœä¸ºç©ºæ—¶æ‰ä¼šè®¡ç®—?:åé¢çš„è¡¨è¾¾å¼
				if (size > 0) {
  				  println("listçš„é•¿åº¦ä¸æ˜¯0")
				}
```



**å…³äº?:**

è¿™ä¸ªä¹Ÿä¸æ˜¯Javaä¸­çš„ä¸‰å…ƒè¿ç®—ç¬¦,kotlinä¸­æ²¡æœ‰ä¸‰å…ƒè¿ç®—ç¬¦ï¼Œå½“å¯¹è±¡å€¼ä¸ºnullçš„æ—¶å€™ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šè¿”å›åé¢çš„å¯¹è±¡

```java
				var name:String = null?:"name"
```

åœ¨kotlinä¸­å¯ä»¥ä½¿ç”¨ä½¿ç”¨ `if/else` æ¥ä»£æ›¿ä¸‰å…ƒè¿ç®—ç¬¦

~~~kotlin
val max = if (a > b) a else b
~~~







### åŒºé—´Range

Rangeè¡¨ç¤ºä¸€ä¸ªå–ä¹‹èŒƒå›´  

```java
				var intRange1: IntRange = 0..100;//åŒ…å«0 å’Œ100
				var intRange2: IntRange = 0 until 100;//åŒ…å«0 ä¸åŒ…å«100
				val intRange3: IntRange = 0..-1  //ä¸å­˜åœ¨
```

```
				// var intRange1: IntRange = 0..100;
        if (i >= 0 && i <= 100) {
        }

        // var intRange2: IntRange = 0 until 100;//åŒ…å«0 ä¸åŒ…å«100
        if (i >= 0 && i < 100) {
        }

        // val intRange3: IntRange = 0..-1  //ä¸å­˜åœ¨ æ²¡æœ‰å¤§äºç­‰äº0åŒæ—¶è¿˜å°äºç­‰äº-1çš„æ•°å­—
        if (i >= 0 && i <= -1) {
        }
```

åŒºé—´è¿˜å¯ä»¥ç”¨æ¥å†™å¾ªç¯ä¸­çš„æ¡ä»¶

~~~java
   for (i in 0 until 10){
       println(i)
   }

		//ç›¸å½“äº
    for (int i = 0; i < 10; i++) {
         System.out.println(i);
    }

    for (i in 0 ..10){
        println(i)
    }

		//ç›¸å½“äº
    for (int i = 0; i <= 10; i++) {
         System.out.println(i);
    }


~~~





### æ•°ç»„å’Œé›†åˆ

**æ•°ç»„**



javaä¸­çš„æ•°ç»„

~~~java
String[] strs = {"a", "b", "c"};
~~~

kotlinä¸­çš„æ•°ç»„

~~~kotlin
val strs: Array<String> = arrayOf("a", "b", "c")
~~~

Kotlin ä¸­çš„æ•°ç»„æ˜¯ä¸€ä¸ªæ‹¥æœ‰æ³›å‹çš„ç±»å’Œé›†åˆæ•°æ®ç±»å‹ä¸€æ ·ã€‚

å–å€¼æ–¹å¼å’Œjavaä¸€æ ·éƒ½æ˜¯é€šè¿‡[] `strs[0]`

Kotlin çš„æ•°ç»„ç¼–è¯‘æˆå­—èŠ‚ç æ—¶ä½¿ç”¨çš„ä»ç„¶æ˜¯ Java çš„æ•°ç»„ï¼Œä½†åœ¨è¯­è¨€å±‚é¢æ˜¯æ³›å‹å®ç°ï¼Œè¿™æ ·ä¼šå¤±å»åå˜ ç‰¹æ€§ï¼Œå°±æ˜¯å­ç±»æ•°ç»„å¯¹è±¡ä¸èƒ½èµ‹å€¼ç»™çˆ¶ç±»çš„æ•°ç»„å˜é‡,javaçš„æ•°ç»„æ˜¯æ”¯æŒåå˜çš„

**é›†åˆ**

Kotlin å’Œ Java ä¸€æ ·æœ‰ä¸‰ç§é›†åˆç±»å‹ï¼šListã€Set å’Œ Map



**List**

~~~java
//in java
List<String> strList = new ArrayList<>();
strList.add("a");
strList.add("b");
strList.add("c");

//in kotlin
val strList = listOf("a", "b", "c")
~~~

Kotlin ä¸­åˆ›å»ºä¸€ä¸ª `List` ç‰¹åˆ«çš„ç®€å•ï¼Œæœ‰ç‚¹åƒåˆ›å»ºæ•°ç»„çš„ä»£ç ã€‚è€Œä¸” Kotlin ä¸­çš„ `List` å¤šäº†ä¸€ä¸ªç‰¹æ€§ï¼šæ”¯æŒ covariantï¼ˆåå˜ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥æŠŠå­ç±»çš„ `List` èµ‹å€¼ç»™çˆ¶ç±»çš„ `List` å˜é‡ï¼š

~~~kotlin
val strs: List<String> = listOf("a", "b", "c")
val anys: List<Any> = strs //String èµ‹å€¼ Any
~~~

**Set**

~~~java
//in java
Set<String> strSet = new HashSet<>();
strSet.add("a");
strSet.add("b");
strSet.add("c");

//in kotlin
val strSet = setOf("a", "b", "c")
~~~

å’Œ `List` ç±»ä¼¼ï¼Œ`Set` åŒæ ·å…·æœ‰ covariantï¼ˆåå˜ï¼‰ç‰¹æ€§

**Map**

~~~java
//in java
Map<String, Integer> map = new HashMap<>();
map.put("key1", 1);
map.put("key2", 2);
map.put("key3", 3);
map.put("key4", 3);

//in kotlin
val map = mapOf("key1" to 1, "key2" to 2, "key3" to 3, "key4" to 3)
~~~

Kotlin ä¸­çš„ Map é™¤äº†å’Œ Java ä¸€æ ·å¯ä»¥ä½¿ç”¨ `get()` æ ¹æ®é”®è·å–å¯¹åº”çš„å€¼ï¼Œè¿˜å¯ä»¥ä½¿ç”¨æ–¹æ‹¬å·[]çš„æ–¹å¼è·å–



**å¯å˜é›†åˆ/ä¸å¯å˜é›†åˆ**

ä¸Šé¢ä»‹ç»çš„ list,set,mapå¹¶å¯¹ç­‰ä¸javaä¸­çš„é›†åˆã€‚è¿™é‡Œé›†åˆéƒ½æ˜¯ä¸å¯å˜çš„ï¼Œç±»ä¼¼æ•°ç»„ï¼Œä¸å¯ä»¥æ·»åŠ æˆ–è€…åˆ é™¤ã€‚

ä»¥ä¸‹æ˜¯ä¸‰ç§é›†åˆç±»å‹åˆ›å»ºä¸å¯å˜å’Œå¯å˜å®ä¾‹çš„ä¾‹å­ï¼š

- `listOf()` åˆ›å»ºä¸å¯å˜çš„ `List`ï¼Œ`mutableListOf()` åˆ›å»ºå¯å˜çš„ `List`ã€‚
- `setOf()` åˆ›å»ºä¸å¯å˜çš„ `Set`ï¼Œ`mutableSetOf()` åˆ›å»ºå¯å˜çš„ `Set`ã€‚
- `mapOf()` åˆ›å»ºä¸å¯å˜çš„ `Map`ï¼Œ`mutableMapOf()` åˆ›å»ºå¯å˜çš„ `Map`ã€‚

æœ‰ `mutable` å‰ç¼€çš„å‡½æ•°åˆ›å»ºçš„æ˜¯å¯å˜çš„é›†åˆï¼Œæ²¡æœ‰ `mutbale` å‰ç¼€çš„åˆ›å»ºçš„æ˜¯ä¸å¯å˜çš„é›†åˆï¼Œä¸è¿‡ä¸å¯å˜çš„å¯ä»¥é€šè¿‡ `toMutable*()` ç³»å‡½æ•°è½¬æ¢æˆå¯å˜çš„é›†åˆ

~~~kotlin
val strList = listOf("a", "b", "c")
strList.toMutableList()

val strSet = setOf("a", "b", "c")  
strSet.toMutableSet()

val map = mapOf("key1" to 1, "key2" to 2, "key3" to 3, "key4" to 3)
map.toMutableMap()
~~~

`toMutable*()` è¿”å›çš„æ˜¯ä¸€ä¸ªæ–°å»ºçš„é›†åˆï¼ŒåŸæœ‰çš„é›†åˆè¿˜æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥åªèƒ½å¯¹å‡½æ•°è¿”å›çš„é›†åˆä¿®æ”¹ã€‚



å…³äºkotlinä¸­çš„ä¸å¯å˜é›†åˆæ”¯æŒåå˜ï¼Œå› ä¸ºä»–ä»¬åœ¨å®šä¹‰çš„æ—¶å€™å°±æŒ‡å®šäº†æ³›å‹<out T>ï¼Œå·²ç»å®ç°äº†åå˜ã€‚å¯å˜é›†åˆä¸æ”¯æŒåå˜ã€‚



### Sequence

 Kotlin è¿˜å¼•å…¥äº†ä¸€ä¸ªæ–°çš„å®¹å™¨ç±»å‹ `Sequence`ï¼Œå®ƒå’Œ `Iterable` ä¸€æ ·ç”¨æ¥éå†ä¸€ç»„æ•°æ®å¹¶å¯ä»¥å¯¹æ¯ä¸ªå…ƒç´ è¿›è¡Œç‰¹å®šçš„å¤„ç†ã€‚

~~~kotlin
//åˆ›å»º
sequenceOf("a", "b", "c")
//listè½¬æ¢
val list = listOf("a", "b", "c")
list.asSequence()
~~~

 `Sequence` åˆè¢«ç§°ä¸ºã€Œæƒ°æ€§é›†åˆæ“ä½œã€

~~~kotlin
val result = sequenceOf(1, 2, 3, 4)
    .map { i ->
        println("Map $i")
        i * 2 
    }
    .filter { i ->
        println("Filter $i")
        i % 3  == 0 
    }
ğŸ‘‡
println(result.first()) // ğŸ‘ˆ åªå–é›†åˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ 
~~~

- æƒ°æ€§çš„æ¦‚å¿µé¦–å…ˆå°±æ˜¯è¯´åœ¨ã€ŒğŸ‘‡ã€æ ‡æ³¨ä¹‹å‰çš„ä»£ç è¿è¡Œæ—¶ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œå®ƒåªæ˜¯å®šä¹‰äº†ä¸€ä¸ªæ‰§è¡Œæµç¨‹ï¼Œåªæœ‰ `result` è¢«ä½¿ç”¨åˆ°çš„æ—¶å€™æ‰ä¼šæ‰§è¡Œ

- å½“ã€ŒğŸ‘‡ã€çš„ `println` æ‰§è¡Œæ—¶æ•°æ®å¤„ç†æµç¨‹æ˜¯è¿™æ ·çš„ï¼š

  - å–å‡ºå…ƒç´  1 -> map ä¸º 2 -> filter åˆ¤æ–­ 2 æ˜¯å¦èƒ½è¢« 3 æ•´é™¤
  - å–å‡ºå…ƒç´  2 -> map ä¸º 4 -> filter åˆ¤æ–­ 4 æ˜¯å¦èƒ½è¢« 3 æ•´é™¤
  - ...

  æƒ°æ€§æŒ‡å½“å‡ºç°æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œ`Sequence` å°±ä¸ä¼šæ‰§è¡Œåé¢çš„å…ƒç´ éå†äº†ï¼Œå³è·³è¿‡äº† `4` çš„éå†ã€‚

è€Œ `List` æ˜¯æ²¡æœ‰æƒ°æ€§çš„ç‰¹æ€§çš„

~~~ko
val list = listOf(1, 2, 3, 4)
val result: List = list
    .map { i ->
        println("Map $i")
        i * 2 
    }
    .filter { i ->
        println("Filter $i")
        i % 3  == 0 
    }
ğŸ‘‡
println(result.first()) // ğŸ‘ˆ åªå–é›†åˆçš„ç¬¬ä¸€ä¸ªå…ƒç´ 
~~~

- å£°æ˜ä¹‹åç«‹å³æ‰§è¡Œ
- æ•°æ®å¤„ç†æµç¨‹å¦‚ä¸‹ï¼š
  - {1, 2, 3, 4} -> {2, 4, 6, 8}
  - éå†åˆ¤æ–­æ˜¯å¦èƒ½è¢« 3 æ•´é™¤

`Sequence` è¿™ç§ç±»ä¼¼æ‡’åŠ è½½çš„å®ç°æœ‰ä¸‹é¢è¿™äº›ä¼˜ç‚¹ï¼š

- ä¸€æ—¦æ»¡è¶³éå†é€€å‡ºçš„æ¡ä»¶ï¼Œå°±å¯ä»¥çœç•¥åç»­ä¸å¿…è¦çš„éå†è¿‡ç¨‹ã€‚
- åƒ `List` è¿™ç§å®ç° `Iterable` æ¥å£çš„é›†åˆç±»ï¼Œæ¯è°ƒç”¨ä¸€æ¬¡å‡½æ•°å°±ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„ `Iterable`ï¼Œä¸‹ä¸€ä¸ªå‡½æ•°å†åŸºäºæ–°çš„ `Iterable` æ‰§è¡Œï¼Œæ¯æ¬¡å‡½æ•°è°ƒç”¨äº§ç”Ÿçš„ä¸´æ—¶ `Iterable` ä¼šå¯¼è‡´é¢å¤–çš„å†…å­˜æ¶ˆè€—ï¼Œè€Œ `Sequence` åœ¨æ•´ä¸ªæµç¨‹ä¸­åªæœ‰ä¸€ä¸ªã€‚

å› æ­¤ï¼Œ`Sequence` è¿™ç§æ•°æ®ç±»å‹å¯ä»¥åœ¨æ•°æ®é‡æ¯”è¾ƒå¤§æˆ–è€…æ•°æ®é‡æœªçŸ¥çš„æ—¶å€™ï¼Œä½œä¸ºæµå¼å¤„ç†çš„è§£å†³æ–¹æ¡ˆã€‚



## ç¨‹åºç»“æ„

### å‡½æ•°

**mainå‡½æ•°**

javaä¸­

~~~java
public class Test {
    public static void main(String[] args){
    }
}
~~~

kotlinæœ‰ä¸¤ç§åˆ›å»ºmainå…¥å£å‡½æ•°çš„æ–¹æ³•ï¼Œä¸€ç§æ˜¯åˆ›å»ºåœ¨classå—å¤–é¢ï¼Œè€Œå¦å¤–ä¸€ç§å°±æ˜¯è·Ÿjavaä¸€æ ·ï¼Œåˆ›å»ºåœ¨classé‡Œé¢

~~~kotlin
class Test{
}
/** mainå…¥å£å‡½æ•°ï¼Œåœ¨ç±»å¤–é¢ **/
fun main(args: Array<String>) {
   
}
~~~

ç±»ä¸­åˆ›å»ºmainå‡½æ•°

~~~kotlin
class Test(private val name: String) {

    companion object {
        @JvmStatic
        fun main(ages:Array<String>){
        }
    }
}
~~~

mainå‡½æ•°è¦ä½¿ç”¨@JvmStaticæ³¨è§£å¹¶æ”¾åˆ°  companion objectçš„ä»£ç å—ä¸­ï¼ˆä»£è¡¨é™æ€ï¼‰ï¼Œkotlinä¸ºäº†æ–¹ä¾¿å¯ä»¥ç›´æ¥åœ¨classå¤–å£°æ˜mainå‡½æ•°ã€‚



**å‡½æ•°çš„å†™æ³•**

å¿…é¡»è¦ä»¥funå…³é”®å­—å¼€å¤´ã€‚æ ‡å‡†çš„å‡½æ•°å†™æ³•å¦‚ä¸‹ï¼š

```java
fun æ ‡å‡†å‡½æ•°(å‚æ•°:String):Unit{
    //å‡½æ•°ä½“
}
```

Unitå’Œjavaä¸­çš„voidä¸€æ ·ï¼Œkotlinä¸­å¦‚æœè¿”å›å€¼æ˜¯Unitå¯ä»¥çœç•¥ä¸å†™ã€‚

```java
fun main(args: Array<String>) {
    test("é˜¿å§†æ–¯ç‰¹æœ—å›æ—‹åŠ é€Ÿå–·æ°”å¼é˜¿å§†æ–¯ç‰¹æœ—ç‚®")
    test1("é˜¿å§†æ–¯ç‰¹æœ—å›æ—‹åŠ é€Ÿå–·æ°”å¼é˜¿å§†æ–¯ç‰¹æœ—ç‚®")
}

fun test(name: String) {
    println("hi,$name")

}
//å•è¡Œå‡½æ•°å¯ä»¥ç›´æ¥çœå»å¤§æ‹¬å·ä½¿ç”¨=é“¾æ¥ è¿”å›å€¼å³å‡½æ•°ä½“çš„èŒƒå›´å€¼
fun test1(name: String) =  println("hi,$name")
//è¿”å›ä¸¤ä¸ªå‚æ•°çš„å’Œ  è¿™é‡Œçš„è¿”å›å€¼:Intå¯ä»¥çœç•¥ä¸å†™
fun test(x: Int, y: Int): Int = x + y
```

åŒ¿åå‡½æ•°

~~~java
val name = fun (name: String) = println("hi,$name")
~~~



**å‡½æ•°ç®€åŒ–**

å¦‚æœå‡½æ•°åªæœ‰ä¸€è¡Œçš„è¯å¯ä»¥ç›´æ¥ä½¿ç”¨`=`çœç•¥å¤§æ‹¬å·

~~~kotlin
    fun getNumber(): Int {
        return 0
    }

    fun getNumber1(): Int = 0
~~~

å› ä¸ºæœ‰ç±»å‹æ¨å¯¼ï¼Œè¿”å›å€¼ä¹Ÿå¯ä»¥ç›´æ¥çœç•¥ã€‚



### Lambdaè¡¨è¾¾å¼

**lambadè¡¨è¾¾å¼æ˜¯ä»€ä¹ˆ**

ç®€å•æ¥è®²ï¼ŒLambdaæ˜¯ä¸€ç§å‡½æ•°çš„è¡¨ç¤ºæ–¹å¼(ä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªLambdaè¡¨è¾¾å¼ç­‰äºä¸€ä¸ªå‡½æ•°)ã€‚æ›´ç¡®åˆ‡çš„è¯´ï¼šLambdaæ˜¯ä¸€ä¸ªæœªå£°æ˜çš„å‡½æ•°ï¼Œä¼šä»¥è¡¨è¾¾å¼çš„å½¢å¼ä¼ é€’ã€‚Lambdaä¹Ÿå¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ã€‚

**Lambdaè¡¨è¾¾å¼è¯­æ³•**

1. lambda è¡¨è¾¾å¼æ€»æ˜¯è¢«å¤§æ‹¬å·æ‹¬ç€ï¼›

2. å…¶å‚æ•°ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰åœ¨ -> ä¹‹å‰å£°æ˜ï¼ˆå‚æ•°ç±»å‹å¯ä»¥çœç•¥ï¼‰(å¦‚æœæ²¡æœ‰å‚æ•°å¯ä»¥çœç•¥ ->)
3. å‡½æ•°ä½“åœ¨ -> åé¢


**å…·ä½“çš„å†™æ³•å¯ä»¥æœ‰ä»¥ä¸‹ä¸¤ç§å†™æ³•**

~~~java
// ç¬¬ä¸€ç§
val sum1 = {x: Int, j: Int -> x + j}
// ç¬¬äºŒç§
val sum2: (x: Int, j: Int) -> Int = {a, b -> a + b }
~~~

åˆ†æä¸€ä¸‹ä¸Šè¿°ä¸¤ç§è¡¨è¾¾å¼ï¼š 
ç¬¬ä¸€ç§æ¯”è¾ƒå¥½ç†è§£ï¼Œé¦–å…ˆ â€˜=â€™ å·¦è¾¹å£°æ˜äº†ä¸€ä¸ªå˜é‡sum1ï¼Œâ€™=â€™ å³è¾¹æ˜¯ä¸€ä¸ªLabmdaè¡¨è¾¾å¼ï¼Œç„¶åå°†å…¶èµ‹å€¼ç»™sum1 
ç¬¬äºŒç§ç¨å¾®å¤æ‚ä¸€ç‚¹ï¼Œä¸»è¦æ˜¯å¤æ‚åœ¨å·¦è¾¹çš„sum2: åé¢çš„è¿™ä¸€å¨ä»£è¡¨ä»€ä¹ˆæ„æ€ã€‚ é¦–å…ˆKotlinå‡½æ•°å‚æ•°æ˜¯ä½¿ç”¨ Pascal è¡¨ç¤ºæ³•å®šä¹‰(name: type)(å‘½å:ç±»å‹), å› æ­¤sum2: åé¢çš„è¿™ä¸€å¨ä»£è¡¨çš„æ˜¯ä¸€ç§ç±»å‹typeï¼Œ(x: Int, j: Int) -> Intè¿™ç§è¡¨è¿°æ–¹å¼å°±æ˜¯è¡¨è¾¾å‡½æ•°çš„ç±»å‹ï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªéœ€è¦ä¼ å…¥ä¸¤ä¸ªIntç±»å‹å‚æ•°ï¼Œå¹¶è¿”å›Intç±»å‹çš„å‡½æ•°ã€‚=åé¢çš„å¤§æ‹¬å·è¡¨è¾¾å¼å³æ˜¯å‰é¢è¿™ä¸ªlambdaçš„å®ç°ã€‚

å…¶å®ä¸¤ç§å†™æ³•æ˜¯ä¸€æ ·çš„ã€‚ç¬¬ä¸€ç§å†™æ³•æ˜¯å› ä¸ºkotlinçš„ç±»å‹æ¨å¯¼ï¼Œçœå»äº†å†™sum1çš„ç±»å‹

**lambdaå¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’**

kotlinä¸­æ‰€æœ‰çš„è¡¨è¾¾å¼éƒ½æ˜¯æœ‰è¿”å›å€¼çš„ï¼Œæ²¡æœ‰è¿”å›å€¼çš„è¿”å›çš„æ˜¯Unitã€‚

~~~java
fun main(args: Array<String>) {
  
    var sum: (x: Int, y: Int) -> Int = { x, y -> x + y }
    test(sum(1,2))
}

fun test(int:Int){
    //do something
}
~~~

ä»¥ä¸Šä»£ç ä¸­å£°æ˜ä¸€ä¸ªtestæ–¹æ³•éœ€è¦ä¸€ä¸ªintå‚æ•°ï¼Œsum Lambdaæ­£å¥½è¿”å›ä¸€ä¸ªintã€‚å…¶å®è¿™ä¸ªå’Œjavaä¸­ä¸€æ ·ã€‚

lambadè¡¨è¾¾å¼ä¹Ÿæœ‰ç±»å‹

```java
/** A function that takes 0 arguments. */
public interface Function0<out R> : Function<R> {
    /** Invokes the function. */
    public operator fun invoke(): R
}
/** A function that takes 1 argument. */
public interface Function1<in P1, out R> : Function<R> {
    /** Invokes the function with the specified argument. */
    public operator fun invoke(p1: P1): R
}
/** A function that takes 2 arguments. */
public interface Function2<in P1, in P2, out R> : Function<R> {
    /** Invokes the function with the specified arguments. */
    public operator fun invoke(p1: P1, p2: P2): R
      
      ......
```

Function0,Function1,Function2å°±æ˜¯ç±»å‹

Function0 = æ²¡æœ‰å‚æ•°

Function1 = 1ä¸ªå‚æ•°

ä»¥æ­¤ç±»æ¨

å£°æ˜ä¸€ä¸ªlambadç±»å‹çš„å˜é‡

```java
    //å£°æ˜lambdaè¡¨è¾¾å¼ ç±»å‹æ˜¯ æ¥å—ä¸¤ä¸ªintå‚æ•°,è¿”å›intç»“æœ
    private val sum: (x: Int, y: Int) -> Int

    init {
        //å£°æ˜ä¹‹åå¿…é¡»è¦åˆå§‹åŒ– åˆå§‹åŒ–å°±æ˜¯å®šä¹‰lambdaçš„å®ç°
        //è¿™é‡Œåªæ˜¯è¿”å›ä¸¤ä¸ªæ•°çš„å’Œ
        sum = { x, y -> x + y }
    }
    
    //å¯ä»¥å†™æˆè¿™æ ·
    private val sum2:(x: Int, y: Int) -> Int ={x, y -> x + y}
```

**lambdaè¡¨è¾¾å¼çš„ä¸€äº›çº¦å®š**

~~~java
public inline fun <T> Array<out T>.forEach(action: (T) -> Unit): Unit {
    for (element in this) action(element)
}
~~~

ä»¥ä¸Šæ˜¯Arrayçš„forEachæ‰©å±•æ–¹æ³•ï¼Œæ¥å—çš„å‚æ•°æ˜¯ ä¸€ä¸ªå‚æ•°è¿”å›Unitç±»å‹çš„è¡¨è¾¾å¼

å…·ä½“è°ƒç”¨å¦‚ä¸‹ï¼š

~~~java
    val intArray = arrayOf(1, 2, 3)
    intArray.forEach(fun(i: Int) {
        println(i)
    })
~~~

ç”¨lambdaè¡¨è¾¾å¼å°±æ˜¯è¿™æ ·

~~~java
intArray.forEach ({i:Int -> println(i)})
~~~

å¦‚æœä¼ å…¥çš„å‚æ•°åªæœ‰ä¸€ä¸ªå¯ä»¥çœç•¥ä¸å†™ï¼Œå¼•ç”¨æ—¶ç”¨itæ¥ä»£æ›¿ï¼Œé‚£å°±å˜æˆäº†è¿™æ ·

~~~java
 intArray.forEach ({ println(it) })
~~~

åœ¨ Kotlin ä¸­æœ‰ä¸€ä¸ªçº¦å®šï¼Œå¦‚æœå‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”ä½ ä¼ é€’ä¸€ä¸ª lambda è¡¨è¾¾å¼ä½œä¸ºç›¸åº”çš„å‚æ•°ï¼Œä½ å¯ä»¥åœ¨åœ†æ‹¬å·ä¹‹å¤–æŒ‡å®šå®ƒ

~~~java
intArray.forEach () {println(it)}
~~~

åœ¨ Kotlinä¸­è¿˜æœ‰å¦å¤–ä¸€ä¸ªçº¦å®šï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°çš„å‚æ•°åªæœ‰ä¸€ä¸ªï¼Œå¹¶ä¸”å‚æ•°ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œé‚£ä¹ˆå¯ä»¥çœç•¥åœ†æ‹¬å·

~~~java
 intArray.forEach { println(it)}
~~~



ä½¿ç”¨Lambdaå¯ä»¥çœå»æ¥å£å®šä¹‰å’Œå®ç°è¿™ä¸€ç¯èŠ‚ï¼Œä½†æ˜¯æ˜¯æœ‰æ¡ä»¶çš„ï¼Œæ­¤æ¥å£å¿…é¡»åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•éœ€è¦å®ç°ï¼Œæ‰å¯ä»¥ä½¿ç”¨Lambdaæ›¿ä»£(æ¯”å¦‚OnClickListenerã€OnItemClickListener)ã€‚å¦‚æœå¤šäº1ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œåˆ™ä¸èƒ½ä½¿ç”¨Lambdaè¿›è¡Œæ›¿ä»£(æ¯”å¦‚OnItemSelectedListener)



### å†…è”å‡½æ•°

**å‡½æ•°çš„è°ƒç”¨**

è°ƒç”¨ä¸€ä¸ªæ–¹æ³•å…¶å®å°±æ˜¯ä¸€ä¸ªæ–¹æ³•å‹æ ˆå’Œå‡ºæ ˆçš„è¿‡ç¨‹ï¼Œè°ƒç”¨æ–¹æ³•æ—¶å‹å…¥æ–¹æ³•æ ˆï¼Œç„¶åæ‰§è¡Œæ–¹æ³•ä½“ï¼Œæ–¹æ³•ç»“æŸåå‡ºæ ˆï¼Œè¿™ä¸ªå‹æ ˆå’Œå‡ºæ ˆçš„è¿‡ç¨‹æ˜¯ä¸€ä¸ªè€—è´¹èµ„æºçš„è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ä¼ é€’å½¢å‚ä¹Ÿä¼šè€—è´¹èµ„æºã€‚å¾ˆå¤šæ—¶å€™æˆ‘ä»¬åœ¨é¢å¯¹è¦åšåŒä¸€æ“ä½œçš„æ—¶å€™ä¼šå°è£…æˆä¸€ä¸ªå…¬å…±æ–¹æ³•ï¼Œä»£ç çœ‹ä¸Šå»ç¡®å®ç®€æ´äº†å¾ˆå¤šã€‚ä½†æ˜¯è¿™ä¸ªæ–¹æ³•ä¼šè¢«å¤šæ¬¡è°ƒç”¨ï¼Œå¢åŠ äº†æ–¹æ³•çš„å‹æ ˆå‡ºæ ˆï¼Œå¢åŠ èµ„æºè€—è´¹ã€‚

**inlineå†…è”å‡½æ•°**

è¢«inlineæ ‡è®°çš„å‡½æ•°å°±æ˜¯å†…è”å‡½æ•°,å…¶åŸç†å°±æ˜¯:åœ¨ç¼–è¯‘æ—¶æœŸ,æŠŠè°ƒç”¨è¿™ä¸ªå‡½æ•°çš„åœ°æ–¹ç”¨è¿™ä¸ªå‡½æ•°çš„æ–¹æ³•ä½“è¿›è¡Œæ›¿æ¢

~~~kotlin
fun main(args: Array<String>) {

    inlineTest("inlineTest")
}

inline fun inlineTest(s:String){
    log(s)
}
~~~

è¿™æ®µä»£ç ç›¸å½“äº

~~~kotlin
fun main(args: Array<String>) {
    log("inlineTest")
}
~~~

åœ¨ç¼–è¯‘åä¼šç›´æ¥å°†inlineå‡½æ•°çš„ä»£ç ç›´æ¥æ›¿æ¢åˆ°è°ƒç”¨å¤„ï¼Œå¦‚æœæœ‰å¤šä¸ªåœ°æ–¹è°ƒç”¨ä¼šè¢«å¤åˆ¶æ›¿æ¢ã€‚å‡å°‘æ–¹æ³•å‹æ ˆ,å‡ºæ ˆï¼Œè¿›è€Œå‡å°‘èµ„æºæ¶ˆè€—;

**å†…è”å‡½æ•°çš„é™åˆ¶**

å½“å†…è”å‡½æ•°çš„å‚æ•°æ˜¯å‡½æ•°æˆ–è€…Lambdaè¡¨è¾¾å¼çš„æ—¶å€™ï¼Œå½“å‰çš„å†…è”å‡½æ•°æ— æ³•ä¼ é€’è¿™ä¸ªå‚æ•°ç»™å…¶ä»–éå†…è”å‡½æ•°ã€‚

~~~kotlin
    inline fun inlineTest(action: () -> Unit) {
        test(action) //è¿™é‡Œä¼šæŠ¥é”™çš„
    }

    fun test(action: () -> Unit) {
    }
~~~

å› ä¸ºåœ¨ç¼–è¯‘åè¿™é‡Œçš„actionå°±ä¸åœ¨æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå·²ç»æ˜¯ä¸€ä¸ªå…·ä½“çš„å€¼ã€‚è€Œtestå‡½æ•°è¦æ¥å—çš„æ˜¯ä¸€ä¸ªè¡¨è¾¾å¼ç±»å‹çš„å‚æ•°ï¼Œè¿™é‡Œå‚æ•°å°±æ— æ³•åŒ¹é…ä¸Šã€‚



### ç±»æˆå‘˜

å’Œjavaä¸­çš„å±æ€§ä¸€æ ·ï¼Œæˆå‘˜å˜é‡ï¼Œæˆå‘˜æ–¹æ³•ã€‚

kotlinè‡ªåŠ¨å®ç°äº†æˆå‘˜å˜é‡çš„setå’Œgetæ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡é‡å†™å»å®ç°

~~~java
class Test {
    //å¤šä¸ªæˆå‘˜åœ¨å˜é‡åé¢é‡å†™getå’Œset
    var a = 10
        //getå’Œsetå¿…é¡»è¿›é˜¶å†™åœ¨æˆå‘˜åé¢ getæ–¹æ³•ä¸­è¿”å›è¦ä½¿ç”¨field,ä¸èƒ½ç›´æ¥ä½¿ç”¨å˜é‡
      	//fieldåªèƒ½åœ¨get setä¸­ä½¿ç”¨
        get() {
            println("é‡æ–°getæ–¹æ³•")
            return field
        }
        set(value) {
            field = value
            println("é‡æ–°seetæ–¹æ³•")
        }

    var b: Int = 20
        get() = field
        set(value) {
            field = value
        }
}
~~~

valä¿®é¥°çš„æˆå‘˜æ˜¯æ²¡æœ‰set()çš„



å»¶æ—¶åˆå§‹åŒ–

```
var i: Int = 0;
//å»¶æ—¶åˆå§‹åŒ–
lateinit var s: String
//å»¶æ—¶åˆå§‹åŒ–val
val s1:String by lazy {
    //æ³¨æ„è¿™ä¸ªåªä¼šåœ¨ä½¿ç”¨æ—¶æ‰§è¡Œ
    "s1"
}
```



**å±æ€§åˆå§‹åŒ–**

**1.å±æ€§çš„åˆå§‹åŒ–å°½å¯èƒ½åœ¨æ„é€ æ–¹æ³•ä¸­å®Œæˆ init()**

**2.æ— æ³•åœ¨æ„é€ æ–¹æ³•ä¸­åˆå§‹åŒ–ï¼Œå°è¯•é™çº§ä¸ºå±€éƒ¨å˜é‡ï¼ˆè¿™æ ·çš„åœºæ™¯æ¯”è¾ƒå°‘ï¼‰**

**3.varç”¨lateinitå»¶æ—¶åˆå§‹åŒ–ï¼Œvalç”¨lazy**

**4.å¯ç”¨ç±»å‹çš„å˜é‡å°½é‡ä¸è¦ç›´æ¥ç”¨nullèµ‹å€¼åˆå§‹åŒ–**



### lateinit ä¸ by lazy (å§”æ‰˜æœºåˆ¶)çš„åº”ç”¨ä¸åŒºåˆ«

**lateinitï¼š**å»¶æ—¶åˆå§‹åŒ–

lateinitæ ‡ç¤ºç€æŸä¸ªå˜é‡å°†ä¼šåœ¨ç¨åçš„æ“ä½œä¸­è¿›è¡Œåˆå§‹åŒ–ï¼Œæ˜¯ç”¨æ¥å¯¹ä¸å¯ç©ºçš„varå˜é‡è¿›è¡Œæ“ä½œçš„ï¼Œå¯¹valå˜é‡æ— æ³•è¿›è¡Œæ“ä½œ

**by lazy** ä»£ç†

valå˜é‡ç›¸å½“äºjavaä¸­çš„**final**å˜é‡ï¼Œåªèƒ½èµ‹å€¼ä¸€æ¬¡

~~~java
    val s1: String by lazy {
        "s1"
    }
~~~

by lazy åªä¼šåœ¨s1ä¸ºnull çš„æ—¶å€™æ‰§è¡Œ



varä½¿ç”¨lateinitï¼Œvalä½¿ç”¨by lazyï¼›
lateinitæ ‡ç¤ºçš„å€¼å¯è¢«å¤šæ¬¡èµ‹å€¼
by lazyæ ‡ç¤ºçš„å€¼ä»…åœ¨ç¬¬ä¸€æ¬¡è¢«è°ƒç”¨æ—¶èµ‹å€¼ï¼Œä¸”æœ‰ä¸”ä»…æœ‰ä¸€æ¬¡ï¼›



### æ„é€ æ–¹æ³•

javaä¸­çš„æ„é€ å‡½æ•°æ˜¯ä¸ç±»åç›¸åŒå³å¯ï¼Œkotliné‡Œé¢çš„æ„é€ å‡½æ•°æ˜¯ç”¨constructorå…³é”®å­—è¡¨ç¤ºã€‚

kotliné‡Œé¢çš„æ„é€ å‡½æ•°åˆ†ä¸ºä¸»æ„é€ å‡½æ•°å’Œæ¬¡æ„é€ å‡½æ•°ã€‚**ä¸»æ„é€ å‡½æ•°åªèƒ½æœ‰ä¸€ä¸ªï¼Œæ¬¡æ„é€ å‡½æ•°ä¸ªæ•°ä¸é™åˆ¶ï¼Œå¯ä»¥æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ª**

**ä¸»æ„é€ å‡½æ•°ç´§è·Ÿåœ¨ç±»ååé¢**

~~~java
//ä¸»æ„é€ æ–¹æ³•å¦‚ä¸‹ï¼Œè·Ÿåœ¨ç±»ååé¢ 
class ConstructorTest constructor(name: String) {
    
    init {
        println("name = $name")
    }

    //æ¬¡æ„é€ æ–¹æ³•ä½¿ç”¨å…³é”®å­—constructor å¹¶è¿”å›æœ¬èº«å®ä¾‹
    constructor(name: String, age: Int) : this(name) {
        println("name = $name age = $age")
    }
    
}
~~~

ä¸»æ„é€ æ–¹æ³•æ˜¯æ²¡æœ‰æ–¹æ³•ä½“çš„ï¼Œå®ƒçš„æ–¹æ³•æ“ä½œæ”¾åˆ°äº†initå‡½æ•°ä¸­

**ä¸»æ„é€ å‡½æ•°çš„å…³é”®å­—constructorå¯ä»¥çœç•¥**

ä½†æœ‰äº›åœºæ™¯ï¼Œ`constructor` æ˜¯ä¸å¯ä»¥çœç•¥çš„ï¼Œä¾‹å¦‚åœ¨ä¸»æ„é€ å™¨ä¸Šä½¿ç”¨ã€Œå¯è§æ€§ä¿®é¥°ç¬¦ã€æˆ–è€…ã€Œæ³¨è§£ã€

~~~kotlin
class User private constructor(name: String) {
//           ğŸ‘† ä¸»æ„é€ å™¨è¢«ä¿®é¥°ä¸ºç§æœ‰çš„ï¼Œå¤–éƒ¨å°±æ— æ³•è°ƒç”¨è¯¥æ„é€ å™¨ constructorä¸å¯çœç•¥
}
~~~



ä¸»æ„é€ å’Œæ¬¡æ„é€ éƒ½ä¼šæ‰§è¡Œinitå‡½æ•°ï¼Œè€Œä¸”æ˜¯å…ˆæ‰§è¡Œinitåå†æ‰§è¡Œæ„é€ æ–¹æ³•ä½“

~~~java
//in java
public class User {
    {
        // åˆå§‹åŒ–ä»£ç å—ï¼Œå…ˆäºä¸‹é¢çš„æ„é€ å™¨æ‰§è¡Œ
    }
    public User() {
    }
}
~~~

~~~kotlin
//in kotlin
class User {
    init {
        // åˆå§‹åŒ–ä»£ç å—ï¼Œå…ˆäºä¸‹é¢çš„æ„é€ å™¨æ‰§è¡Œ
    }
    constructor() {
    }
}
~~~

**æ¬¡æ„é€ å‡½æ•°**

æ¬¡æ„é€ å‡½æ•°ä½¿ç”¨constructorï¼Œå¦‚æœå·²ç»å£°æ˜çš„ä¸»æ„é€ å‡½æ•°ï¼Œæ¬¡æ„é€ å‡½æ•°æ¯æ¬¡éƒ½éœ€è¦ä½¿ç”¨thiså…³é”®å­—è°ƒç”¨ä¸»æ„é€ å™¨ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨æˆ–è€…é€šè¿‡åˆ«çš„æ¬¡æ„é€ å™¨é—´æ¥è°ƒç”¨ã€‚

æ¬¡æ„é€ å‡½æ•°ä¼šå…ˆè°ƒç”¨ä¸»æ„é€ å‡½æ•°

~~~kotlin
class User constructor(var name: String) {
                                   // ğŸ‘‡  ğŸ‘‡ ç›´æ¥è°ƒç”¨ä¸»æ„é€ å™¨
    constructor(name: String, id: Int) : this(name) {
    }
                                                // ğŸ‘‡ é€šè¿‡ä¸Šä¸€ä¸ªæ¬¡æ„é€ å™¨ï¼Œé—´æ¥è°ƒç”¨ä¸»æ„é€ å™¨
    constructor(name: String, id: Int, age: Int) : this(name, id) {
    }
}
~~~



**æ„é€ å‡½æ•°å£°æ˜å˜é‡**

æ„é€ å‡½æ•°ä¸­å¯ä»¥è®¾ç½®é»˜è®¤å‚æ•°

~~~kotlin
class Test (var name: String = ""){

    init {
        println("init,ä¸»æ„é€ å‡½æ•°æ–¹æ³•ä½“ã€‚$name")

    }

    constructor( id:Int ,name: String = "" ):this(name){
        println("init,ä¸»æ„é€ å‡½æ•°æ–¹æ³•ä½“ã€‚$id")
    }

}
~~~

åœ¨åˆ›å»ºçš„æ—¶å€™ï¼Œå¦‚æœä¸ä¼ å…¥å®å‚ä¼šä½¿ç”¨é»˜è®¤å‚æ•°ã€‚

æ„é€ å‡½æ•°ä¸­ä¹Ÿå¯ä»¥ç›´æ¥å£°æ˜å˜é‡ï¼Œå¦‚ä¸Šä»£ç ä¸»æ„é€ ä¸­`var name: String`ï¼Œæ•ˆæœç­‰äºå£°æ˜äº†ä¸€ä¸ªnameå˜é‡æ¥å—ä¼ å…¥çš„nameå€¼ã€‚åœ¨ç±»çš„æ‰€æœ‰æˆå‘˜ä¸­éƒ½å¯ä»¥ä½¿ç”¨ã€‚

**åªæœ‰ä¸»æ„é€ å‡½æ•°å¯ä»¥å£°æ˜å˜é‡ï¼Œæ¬¡æ„é€ ä¸å¯ä»¥**

å› ä¸ºä¸»æ„é€ æ˜¯å¿…é¡»æ‰§è¡Œçš„ï¼Œæ¬¡æ„é€ ä¸ä¸€å®šã€‚å¦‚æœæ²¡æœ‰æ‰§è¡Œæ¬¡æ„é€ å‡½æ•°è¿™ä¸ªå˜é‡å°±ä¸å­˜åœ¨ã€‚



### åˆ†æ”¯è¡¨è¾¾å¼

åˆ†æ”¯è¡¨è¾¾å¼æœ€åŸºæœ¬çš„å°±æ˜¯ifè¯­å¥,ç”¨æ³•ä¹Ÿå’Œjavaä¸­ä¸€æ ·ã€‚

if è¡¨è¾¾å¼ä¹Ÿæ˜¯æœ‰è¿”å›å€¼çš„

~~~java
    val int = if (true) {
        0
    } else {
        1
    }
~~~

æ³¨æ„ ä¸Šé¢è¿™æ ·çš„èµ‹å€¼æ“ä½œåˆ†æ”¯å¿…é¡»è¦å®Œå–„ï¼Œæœ€åä¸€å®šè¦æœ‰else





### ä¸­ç¼€è¡¨è¾¾å¼

å…¶å®å°±æ˜¯ç±»ä¼¼javaä¸­`int instanceof Integer`

ä¸­ç¼€è¡¨è¾¾å¼å¯ä»¥ç”¨æ¥è‡ªå®šä¹‰è¿ç®—ç¬¦ï¼Œæ¯”å¦‚ åœ¨éå†æ•°ç»„çš„æ—¶å€™

~~~java
 for (string in strings)
~~~

è¿™é‡Œçš„inå°±æ˜¯ä¸­ç¼€è¡¨è¾¾å¼



1.ä¸­ç¼€è¡¨è¾¾å¼å¿…é¡»ä½¿ç”¨infixä¿®é¥°å‡½æ•°

2.åªèƒ½æœ‰ä¸€ä¸ªå‚æ•°

~~~java
infix fun String.has(name: String): Boolean {

    return true
}
~~~

~~~java
    val isHas = "åŒ—äº¬" has "äº”é“å£"
~~~





### whenè¡¨è¾¾å¼

whenè¡¨è¾¾å¼å¯ä»¥çœ‹æˆæ˜¯javaä¸­switchçš„åŠ å¼ºç‰ˆï¼Œæ›´åŠ ç®€å•æš´åŠ›ä¸”æ”¯æŒä»»æ„ç±»å‹

~~~java
    //æŒ‰é¡ºåºå¾€ä¸‹æ‰§è¡Œ ä»»æ„ä¸€æ¡åŒ¹é…æ‰§è¡Œåå³breakè·³å‡º
    //defaultç”¨elseä»£æ›¿
    val x = 100
    when (x) {

        0, 1 -> println(" x = $x")

        10 -> println(" x = 10 ...")

        else -> println(" x = else ")
    }
~~~



- çœç•¥äº† `case` å’Œ `break`ï¼Œ Kotlin è‡ªåŠ¨ä¸ºæ¯ä¸ªåˆ†æ”¯åŠ ä¸Šäº† `break` çš„åŠŸèƒ½ï¼Œé˜²æ­¢æ¼å†™
- Java ä¸­çš„é»˜è®¤åˆ†æ”¯ä½¿ç”¨çš„æ˜¯ `default` å…³é”®å­—ï¼ŒKotlin ä¸­ä½¿ç”¨çš„æ˜¯ `else`



åœ¨ Java ä¸­ï¼Œå½“å¤šç§æƒ…å†µæ‰§è¡ŒåŒä¸€ä»½ä»£ç æ—¶ï¼š

~~~java
switch (x) {
    case 1:
    case 2: {
        System.out.println("x == 1 or x == 2");
        break;
    }
}
~~~

kotlinä¸­

~~~kotlin
when (x) {
    1, 2 -> print("x == 1 or x == 2")
    else -> print("else")
}
~~~

åœ¨ `when` è¯­å¥ä¸­ï¼Œè¿˜å¯ä»¥ä½¿ç”¨è¡¨è¾¾å¼ä½œä¸ºåˆ†æ”¯çš„åˆ¤æ–­æ¡ä»¶ï¼š

~~~kotlin
when (x) {
    in 1..10 -> print("x åœ¨åŒºé—´ 1..10 ä¸­")
    in listOf(1,2) -> print("x åœ¨é›†åˆä¸­")
    // not in
    !in 10..20 -> print("x ä¸åœ¨åŒºé—´ 10..20 ä¸­")
    else -> print("ä¸åœ¨ä»»ä½•åŒºé—´ä¸Š")
}
~~~

ä¹Ÿå¯ä»¥isåˆ¤æ–­

~~~kotlin
val isString = when(x) {
    //å®é™…ä½¿ç”¨ç”¨ifä¼šæ›´å¥½
    is String -> true
    else -> false
}
~~~

è¿˜å¯ä»¥çœç•¥ `when` åé¢çš„å‚æ•°ï¼Œæ¯ä¸€ä¸ªåˆ†æ”¯æ¡ä»¶éƒ½å¯ä»¥æ˜¯ä¸€ä¸ªå¸ƒå°”è¡¨è¾¾å¼

~~~kotlin
when {
    str1.contains("a") -> print("å­—ç¬¦ä¸² str1 åŒ…å« a")
    str2.length == 3 -> print("å­—ç¬¦ä¸² str2 çš„é•¿åº¦ä¸º 3")
}
~~~

å½“åˆ†æ”¯çš„åˆ¤æ–­æ¡ä»¶ä¸ºè¡¨è¾¾å¼æ—¶ï¼Œå“ªä¸€ä¸ªæ¡ä»¶å…ˆä¸º `true` å°±æ‰§è¡Œå“ªä¸ªåˆ†æ”¯çš„ä»£ç å—ã€‚



åŒæ · whenè¡¨è¾¾å¼çš„æ¯ä¸ªåˆ†æ”¯ä¹Ÿæœ‰è¿”å›å€¼





### å¾ªç¯è¯­å¥

å¾ªç¯è¯­å¥å’ŒjavaåŸºæœ¬ä¸€æ ·ï¼Œæœ‰forå¾ªç¯ï¼Œwhileå¾ªç¯å’Œdo whileå¾ªç¯ã€‚ä¹Ÿæœ‰continue å’Œbreakå…³é”®å­—

**forå¾ªç¯**

java

~~~java
int[] array = {1, 2, 3, 4};
for (int item : array) {
  //é«˜çº§for
}
~~~

 Kotlin ä¸­ï¼Œä¸ç”¨æ˜¾å¼çš„å£°æ˜ç±»å‹ itemçš„ç±»å‹ï¼Œä½¿ç”¨ `in` å…³é”®å­—ï¼Œè¡¨ç¤º `item` æ˜¯ `array` é‡Œé¢çš„ä¸€ä¸ªå…ƒç´ 

~~~kotlin
val array = intArrayOf(1, 2, 3, 4)
for (item in array) {
}
~~~

`in` åé¢çš„å˜é‡å¯ä»¥æ˜¯ä»»ä½•å®ç° `Iterable` æ¥å£çš„å¯¹è±¡ï¼Œæ¯”å¦‚Range

javaéå†ä» 0 åˆ° 10

```java
for (int i = 0; i <= 10; i++) {
}
```

kotlinä¸­æ²¡æœ‰è¿™ç§å†™æ³• ï¼Œå¯ä»¥ä½¿ç”¨inå…³é”®å­—å’ŒRangeå®ç°

~~~kot
for (i in 0..10) {
    println(i)
}
~~~













### å¼‚å¸¸æ•è·(try,catch,finally)

å¼‚å¸¸ä¹Ÿå’Œjavaä¸­ä¸€æ ·



### å…·åå‚æ•°ï¼Œå˜é•¿å‚æ•°ï¼Œé»˜è®¤å‚æ•°



**å…·åå‚æ•°å…¶å®å°±æ˜¯ç»™å®å‚é™„ä¸Šå½¢å‚** 

```java
fun sum(a: Int, b: Int) {
    a + b
}
```

```java
sum(a = 1,b = 2)
sum(b = 2,a = 1)
```

åœ¨è°ƒç”¨çš„æ—¶å€™æŒ‡å®šå‚æ•°çš„å€¼ï¼Œè¿™æ ·è®¡ç®—è°ƒæ¢äº†aå’Œbçš„ä½ç½®ï¼Œä»–ä»¬çš„å€¼ä¾ç„¶ä¸å˜



**å˜é•¿å‚æ•°**

ç±»ä¼¼javaä¸­çš„å¯å˜å‚æ•°ã€‚ä½†æ˜¯javaä¸­å¯å˜å‚æ•°åªèƒ½æ˜¯æ–¹æ³•å‚æ•°çš„æœ€åä¸€ä¸ªï¼Œkotlinä¸­å› ä¸ºæœ‰å…·åå‚æ•°çš„å­˜åœ¨ä¸é™åˆ¶å¯å˜å‚æ•°çš„ä½ç½®

~~~java
fun test(vararg ints:Int,string: String){
    //doSomething
}
~~~

~~~java
test(1,2,3,string ="test")
~~~



**é»˜è®¤å‚æ•°**

å’Œæ„é€ å‡½æ•°ä¸€æ ·ï¼Œç»™å‡½æ•°çš„å‚æ•°è®¾ç½®é»˜è®¤å€¼ï¼Œå¦‚æœè°ƒç”¨è€…æ²¡æœ‰ä¼ é€’å‚æ•°å°±ä½¿ç”¨é»˜è®¤å€¼

~~~java
fun test(double: Double, vararg ints: Int, string: String = "test"){
    //string æœ‰é»˜è®¤å€¼ å¤–ç•Œä¸ä¼ å€¼å¾—è¯å°±ä¼šä½¿ç”¨é»˜è®¤å€¼
}
~~~

~~~java
test(0.1,1,2) //è°ƒç”¨çš„æ—¶å€™æ²¡æœ‰ä¼ é€’string å¦‚æœstringä¸æ˜¯åœ¨æœ€åä¸€ä¸ªï¼Œè¦ä½¿ç”¨å…·åå‚æ•°æ¥æŒ‡å®šå…¶ä»–å‚æ•°
~~~



## é¢å‘å¯¹è±¡

### æ¥å£

kotlinä¸­çš„æ¥å£å¯ä»¥æœ‰é»˜è®¤å®ç°

~~~java
interface Driver {
    fun drive(){
        println("drive")
    }
}
~~~





### ç»§æ‰¿

`open`å…³é”®å­—

kotlinä¸­é»˜è®¤çš„ç±»å’Œæ–¹æ³•éƒ½æ˜¯ä¸èƒ½è¢«ç»§æ‰¿çš„ï¼Œéœ€è¦ç”¨openå…³é”®å­—ä¿®é¥°çš„æ‰èƒ½è¢«ç»§æ‰¿ã€‚æ‰€æœ‰æŠ½è±¡ç±»ã€æŠ½è±¡æ–¹æ³•ã€æ¥å£é™¤å¤–ï¼Œä»–ä»¬é»˜è®¤å°±æ˜¯opençš„ã€‚



æ¥å£ä»£ç†

ç±»ä¼¼javaä¸­çš„æ¥å£ç»§æ‰¿

~~~java
//å®šä¹‰å‡ºä¸¤ä¸ªæ¥å£ å¼€è½¦å’Œå·¥ä½œ
interface Driver {
    fun drive()
}

interface Work {
    fun work()
}

//å®šä¹‰ä¸€ä¸ªPersion å¯ä»¥å¼€è½¦å’Œå·¥ä½œ
class Persion : Driver, Work {

    override fun drive() {
        //to drive
    }

    override fun work() {
        //to work

    }
}
~~~

Persionç»§æ‰¿äº†Driverå’ŒWorkï¼Œè‡ªç„¶è¦å®ç°å„è‡ªçš„æŠ½è±¡æ–¹æ³•

~~~java
//å®šä¹‰ä¸¤ä¸ªåˆ†åˆ«å®ç°çš„ç±»
class CarDriver : Driver {
    override fun drive() {
        println("å¼€è½¦")
    }
}

class PPTWriter : Work {
    override fun work() {
        println("å¹²æ´»")
    }
}

// å®šä¹‰å‡ºManager å¹¶æœ‰å…¶ä»–äººä»£ç†å®Œæˆ å¼€è½¦å’Œå·¥ä½œ
class Manager(driver: Driver, work: Work) : Driver by driver, Work by work {
    //å‚æ•°æ¥æ”¶ Driver å’Œ Work ,é€šè¿‡byå…³é”®å­—æœ‰ä¼ é€’è¿›æ¥çš„å‚æ•°å®ç°æŠ½è±¡æ–¹æ³•
    //Manageræœ¬èº«æ— éœ€å†å®ç° ç»§æ‰¿çš„æŠ½è±¡æ–¹æ³•

}
~~~

Managerçš„å‚æ•°éœ€è¦Driver å’ŒWork å¹¶å°†æŠ½è±¡æ–¹æ³•æ•™ç»™ä»–ä»¬å»å®ç°



**ç»§æ‰¿æ€»ç»“**

**1.çˆ¶ç±»éœ€è¦openæ‰èƒ½è¢«ç»§æ‰¿**

**2.çˆ¶ç±»æ–¹æ³•ï¼Œå±æ€§éœ€è¦openæ‰èƒ½å¤å†™**

**3.å¤å†™éœ€è¦æ·»åŠ overrideå…³é”®å­—**

**4.ç»§æ‰¿å†™æ³• `class B : A`**

**5.ç»§æ‰¿ç±»æ—¶å®é™…ä¸Šæ˜¯è°ƒç”¨äº†çˆ¶ç±»çš„æ„é€ æ–¹æ³•**

**6.å’Œjavaä¸€æ ·ç±»åªèƒ½å•ç»§æ‰¿ï¼Œæ¥å£å¯ä»¥å¤šå®ç°**





### ç±»åŠå…¶æˆå‘˜çš„å¯è§æ€§ï¼ˆprivate,protected,internal,publicï¼‰

- `public`ï¼šå…¬å¼€ï¼Œå¯è§æ€§æœ€å¤§ï¼Œå“ªé‡Œéƒ½å¯ä»¥å¼•ç”¨ã€‚kotlinä¸­é»˜è®¤å°±æ˜¯public
- `private`ï¼šç§æœ‰ï¼Œå¯è§æ€§æœ€å°ï¼Œæ ¹æ®å£°æ˜ä½ç½®ä¸åŒå¯åˆ†ä¸ºç±»ä¸­å¯è§å’Œæ–‡ä»¶ä¸­å¯è§ã€‚
- `protected`ï¼šä¿æŠ¤ï¼Œè‡ªèº«å­ç±»å¯è§ã€‚
- `internal`ï¼šå†…éƒ¨ï¼Œä»…å¯¹ module å†…å¯è§ã€‚

ç›¸æ¯” Java å°‘äº†ä¸€ä¸ª `default` ã€ŒåŒ…å†…å¯è§ã€ä¿®é¥°ç¬¦ï¼Œå¤šäº†ä¸€ä¸ª `internal`ã€Œmodule å†…å¯è§ã€ä¿®é¥°ç¬¦ã€‚



**public**

å’Œjavaçš„publicå…·æœ‰ç›¸åŒæ•ˆæœã€‚åœ¨ Kotlin ä¸­ `public` ä¿®é¥°ç¬¦å¯ä»¥çœç•¥ä¸å†™ã€‚



**private**

- Java ä¸­çš„ `private` è¡¨ç¤ºç±»ä¸­å¯è§ï¼Œä½œä¸ºå†…éƒ¨ç±»æ—¶å¯¹å¤–éƒ¨ç±»å¯è§ã€‚

- Kotlin ä¸­çš„ `private` è¡¨ç¤ºç±»ä¸­æˆ–æ‰€åœ¨æ–‡ä»¶å†…å¯è§ï¼Œä½œä¸ºå†…éƒ¨ç±»æ—¶å¯¹å¤–éƒ¨ç±»ä¸å¯è§

  åœ¨ Java ä¸­ï¼Œå¤–éƒ¨ç±»å¯ä»¥è®¿é—®å†…éƒ¨ç±»çš„ `private` å˜é‡ã€‚åœ¨ Kotlin ä¸­ï¼Œå¤–éƒ¨ç±»ä¸å¯ä»¥è®¿é—®å†…éƒ¨ç±»çš„ `private` å˜é‡ã€‚



**protected**

- Java ä¸­ `protected` è¡¨ç¤ºåŒ…å†…å¯è§ + å­ç±»å¯è§ã€‚
- Kotlin ä¸­ `protected` è¡¨ç¤º `private` + å­ç±»å¯è§ã€‚

Kotlin ç›¸æ¯” Java `protected` çš„å¯è§èŒƒå›´æ”¶çª„äº†ï¼ŒåŸå› æ˜¯ Kotlin ä¸­ä¸å†æœ‰ã€ŒåŒ…å†…å¯è§ã€çš„æ¦‚å¿µäº†ï¼Œç›¸æ¯” Java çš„å¯è§æ€§ç€çœ¼äº `package`ï¼ŒKotlin æ›´å…³å¿ƒçš„æ˜¯ moduleã€‚



**internal**

åœ¨ Android çš„å®˜æ–¹ sdk ä¸­ï¼Œæœ‰ä¸€äº›æ–¹æ³•åªæƒ³å¯¹ sdk å†…å¯è§ï¼Œä¸æƒ³å¼€æ”¾ç»™ç”¨æˆ·ä½¿ç”¨ï¼ˆå› ä¸ºè¿™äº›æ–¹æ³•ä¸å¤ªç¨³å®šï¼Œåœ¨åç»­ç‰ˆæœ¬ä¸­å¾ˆæœ‰å¯èƒ½ä¼šä¿®æ”¹æˆ–åˆ æ‰ï¼‰ã€‚ä¸ºäº†å®ç°è¿™ä¸ªç‰¹æ€§ï¼Œä¼šåœ¨æ–¹æ³•çš„æ³¨é‡Šä¸­æ·»åŠ ä¸€ä¸ª Javadoc æ–¹æ³• `@hide`ï¼Œç”¨æ¥é™åˆ¶å®¢æˆ·ç«¯è®¿é—®ï¼š

~~~java
/**
* @hide 
*/
public void hideMethod() {
    ...
}
~~~

ä½†è¿™ç§é™åˆ¶ä¸å¤ªä¸¥æ ¼ï¼Œå¯ä»¥é€šè¿‡åå°„è®¿é—®åˆ°é™åˆ¶çš„æ–¹æ³•ã€‚é’ˆå¯¹è¿™ä¸ªæƒ…å†µï¼ŒKotlin å¼•è¿›äº†ä¸€ä¸ªæ›´ä¸ºä¸¥æ ¼çš„å¯è§æ€§ä¿®é¥°ç¬¦ï¼š`internal`ã€‚

`internal` è¡¨ç¤ºä¿®é¥°çš„ç±»ã€å‡½æ•°ä»…å¯¹ module å†…å¯è§ï¼Œ`internal` åœ¨å†™ä¸€ä¸ª library module æ—¶éå¸¸æœ‰ç”¨ï¼Œå½“éœ€è¦åˆ›å»ºä¸€ä¸ªå‡½æ•°ä»…å¼€æ”¾ç»™ module å†…éƒ¨ä½¿ç”¨ï¼Œä¸æƒ³å¯¹ library çš„ä½¿ç”¨è€…å¯è§ï¼Œè¿™æ—¶å°±åº”è¯¥ç”¨ `internal` å¯è§æ€§ä¿®é¥°ç¬¦ã€‚



**default**

java çš„ `default`ã€ŒåŒ…å†…å¯è§ã€åœ¨ Kotlin ä¸­è¢«å¼ƒç”¨æ‰äº†ã€‚Kotlin é¼“åŠ±åˆ›å»º top-level å‡½æ•°å’Œå±æ€§ï¼Œä¸€ä¸ªæºç æ–‡ä»¶å¯ä»¥åŒ…å«å¤šä¸ªç±»ï¼Œä½¿å¾— Kotlin çš„æºç ç»“æ„æ›´åŠ æ‰å¹³åŒ–ï¼ŒåŒ…ç»“æ„ä¸å†åƒ Java ä¸­é‚£ä¹ˆé‡è¦ã€‚



### object

å½“ç±»ç”¨objectå…³é”®å­—ä¿®é¥°åå°±å˜æˆäº†å¦‚ä¸‹çš„javaä»£ç 

~~~java
//kotlinä¸­
object  Singleton{
}
~~~

~~~java
//javaä¸­
public class Singleton {
    public static Singleton INSTANCE = new Singleton();

    private Singleton(){}

}
~~~

ç›¸å½“äºjavaä¸­åˆ›å»ºäº†ä¸€ä¸ªè‡ªèº«çš„é™æ€å˜é‡å¹¶ç§æœ‰äº†æ„é€ ï¼Œå¯ä»¥ç›´æ¥è¿™ä¹ˆä½¿ç”¨

~~~java
object  Singleton{

    fun singleton(){}
}

fun main() {

    Singleton.singleton()

}
~~~



**objectå…³é”®å­—ä¿®é¥°**

**1.ç§æœ‰äº†æ„é€ ï¼Œè‡ªèº«åˆ›å»ºé™æ€å¯¹è±¡ï¼Œç›¸å½“äºä¸€ä¸ªç®€å•çš„å•ä¾‹æ¨¡å¼**

**2.å’Œæ™®é€šçš„ç±»ä¸€æ ·å¯ä»¥ç»§æ‰¿ï¼Œå®ç°æ¥å£**

**3.å› ä¸ºç§æœ‰äº†æ„é€ ï¼Œä¸èƒ½å†åˆ›å»ºå¯¹è±¡**



### é™æ€æˆå‘˜ã€ä¼´ç”Ÿå¯¹è±¡å’ŒåŒ…çº§å‡½æ•°

javaä¸­çš„é™æ€æ–¹æ³•

~~~java
    public static String getName(){
        return "name";
    }
~~~



åœ¨ `Kotlin` é‡Œï¼Œé™æ€å˜é‡å’Œé™æ€æ–¹æ³•è¿™ä¸¤ä¸ªæ¦‚å¿µè¢«å»é™¤äº†ã€‚é‚£å¦‚æœæƒ³åœ¨ Kotlin ä¸­åƒ Java ä¸€æ ·é€šè¿‡ç±»ç›´æ¥å¼•ç”¨å¯ä»¥ä½¿ç”¨ `companion object`

~~~java
    companion object{
        fun getName():String{
           return "name"
        }
    }
~~~



**object**

kotlin é‡Œçš„ `object` (é¦–å­—æ¯å°å†™çš„ï¼Œä¸æ˜¯å¤§å†™)ï¼ŒJava é‡Œçš„ `Object` åœ¨ Kotlin é‡Œæ²¡æœ‰äº†ã€‚

> Java ä¸­çš„ `Object` åœ¨ Kotlin ä¸­å˜æˆäº† `Any`ï¼Œå’Œ `Object` ä½œç”¨ä¸€æ ·ï¼šä½œä¸ºæ‰€æœ‰ç±»çš„åŸºç±»ã€‚

è€Œ `object` ä¸æ˜¯ç±»ï¼Œæ˜¯ Kotlin ä¸­çš„å…³é”®å­—

~~~kotlin
object Sample {
    val name = "name"
}
~~~

ä»¥ä¸Šä»£ç åˆ›å»ºä¸€ä¸ªç±»ï¼Œå¹¶ä¸”åˆ›å»ºä¸€ä¸ªè¿™ä¸ªç±»çš„å¯¹è±¡ã€‚è¿™ä¸ªå°±æ˜¯ `object` çš„æ„æ€ï¼šå¯¹è±¡ã€‚

åœ¨ä»£ç ä¸­å¦‚æœè¦ä½¿ç”¨è¿™ä¸ªå¯¹è±¡ï¼Œç›´æ¥é€šè¿‡å®ƒçš„ç±»åå°±å¯ä»¥è®¿é—®ï¼š

~~~kotlin
Sample.name
~~~

kontlinä¸­ä½¿ç”¨objectä¿®é¥°çš„ç±»ï¼Œå®ƒçš„æ–¹æ³•å…¨éƒ½æ˜¯é™æ€æ–¹æ³•ã€‚å…¶å®ç”¨objectä¿®é¥°ç±»ç›¸å½“äºjavaä¸­ä¸€ä¸ªé¥¿æ±‰å¼çš„çº¿ç¨‹å®‰å…¨çš„å•ä¾‹ã€‚

å’Œ Java ç›¸æ¯”çš„ä¸åŒç‚¹æœ‰ï¼š

- å’Œç±»çš„å®šä¹‰ç±»ä¼¼ï¼Œä½†æ˜¯æŠŠ `class` æ¢æˆäº† `object` ã€‚
- ä¸éœ€è¦é¢å¤–ç»´æŠ¤ä¸€ä¸ªå®ä¾‹å˜é‡ `sInstance`ã€‚
- ä¸éœ€è¦ã€Œä¿è¯å®ä¾‹åªåˆ›å»ºä¸€æ¬¡ã€çš„ `getInstance()` æ–¹æ³•ã€‚

çœå»äº†å¤§é‡çš„æ¨¡æ¿ä»£ç ã€‚

Kotlin ä¸­ä¸ä»…ç±»å¯ä»¥ç»§æ‰¿åˆ«çš„ç±»ï¼Œå¯ä»¥å®ç°æ¥å£ï¼Œè¿˜å¯ä»¥ç”¨æ¥åˆ›å»ºå†…éƒ¨ç±»ã€‚

**companion object**

ç”¨ `object` ä¿®é¥°çš„å¯¹è±¡ä¸­çš„å˜é‡å’Œå‡½æ•°éƒ½æ˜¯é™æ€çš„ï¼Œä½†æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬åªæƒ³è®©ç±»ä¸­çš„ä¸€éƒ¨åˆ†å‡½æ•°å’Œå˜é‡æ˜¯é™æ€ã€‚è¿™æ˜¯ç”¨å°±è¦ä½¿ç”¨`companion object`

~~~kotlin
class A {
    object B {
        var c: Int = 0
    }
}
~~~

è°ƒç”¨çš„æ—¶å€™

~~~kotlin
A.B.c
~~~

è¿™ç§åµŒå¥—ç±»å¯ä»¥ç›´æ¥ä½¿ç”¨`companion object`ç®€åŒ–

~~~kotlin
class A {
    companion object {
        var c: Int = 0
    }
}
//å¯ä»¥ç›´æ¥çœç•¥class B
~~~

`ompanion` å¯ä»¥ç†è§£ä¸ºä¼´éšã€ä¼´ç”Ÿï¼Œè¡¨ç¤ºä¿®é¥°çš„å¯¹è±¡å’Œå¤–éƒ¨ç±»ç»‘å®šã€‚ä¸€ä¸ªç±»ä¸­æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªä¼´ç”Ÿå¯¹è±¡

Java é™æ€æˆå‘˜çš„åœ¨kotlinä¸­çš„å†™æ³•å°±å˜æˆäº†`companion object` 



**å’Œjavaä¸€æ ·ï¼Œé™æ€æˆå‘˜æ— æ³•è°ƒç”¨éé™æ€æˆå‘˜**



**åŒ…çº§å‡½æ•°(top-level)**

åŒ…çº§å‡½æ•°åˆå«top-level property / function

åŒ…çº§æˆå‘˜ä¸å­˜åœ¨ä¸ç±»ä¸­ï¼ˆåŒ…çº§æˆå‘˜çš„å£°æ˜ä¸åœ¨ç±»é‡Œï¼‰ï¼Œå½“éœ€è¦ä½¿ç”¨é™æ€æ–¹æ³•çš„æ—¶å€™å¯ä»¥ä¼˜å…ˆè€ƒè™‘åŒ…çº§å‡½æ•°ã€‚ä½¿ç”¨æ–¹æ³•ä¹Ÿå’Œé™æ€æ–¹æ³•ç±»ä¼¼ï¼Œä½†æ˜¯ä¸éœ€è¦ä»»ä½•å¯¹è±¡æˆ–è€…ç±»åè°ƒç”¨ã€‚å¯ä»¥ç›´æ¥è°ƒç”¨æ”¹æ–¹æ³•



åœ¨å®é™…ä½¿ç”¨ä¸­ï¼Œåœ¨ `object`ã€`companion object` å’Œ top-level çš„é€‰æ‹©

ç®€å•æ¥è¯´æŒ‰ç…§ä¸‹é¢è¿™ä¸¤ä¸ªåŸåˆ™åˆ¤æ–­ï¼š

- å¦‚æœæƒ³å†™å·¥å…·ç±»çš„åŠŸèƒ½ï¼Œç›´æ¥åˆ›å»ºæ–‡ä»¶ï¼Œå†™ top-levelã€Œé¡¶å±‚ã€å‡½æ•°ã€‚
- å¦‚æœéœ€è¦ç»§æ‰¿åˆ«çš„ç±»æˆ–è€…å®ç°æ¥å£ï¼Œå°±ç”¨ `object` æˆ– `companion object`ã€‚







### æ–¹æ³•é‡è½½

kotlinä¸­çš„æ–¹æ³•é‡è½½å’Œjavaä¸­ä¸€æ ·ã€‚

é‡è½½å’Œé‡å†™ï¼š

é‡è½½ï¼šæ–¹æ³•åç§»æ¤ï¼Œå‚æ•°ä¸åŒã€‚ä¸è¿”å›å€¼æ— å…³

é‡å†™ï¼šå­ç±»é›†æˆçˆ¶ç±»çš„æ–¹æ³•ï¼Œæ–¹æ³•å å‚æ•° è¿”å›å€¼éƒ½ä¸€æ ·ã€‚

è¿™é‡Œä¼šæ¶‰åŠåˆ°ä¸€ä¸ªjvmå‡½æ•°ç­¾åçš„æ¦‚å¿µï¼Œjvmè®¤ä¸ºå‡½æ•°å”¯ä¸€çš„æ ‡å¿—æ˜¯æ ¹æ®å‡½æ•°åå’Œå‚æ•°ç¡®å®šï¼Œä¸è¿”å›å€¼æ— å…³

javaä¸­æœ‰ä¸ªå…³äºé‡è½½å¾ˆä¸å¥½å®ç°ï¼ŒList çš„

```java
List<Integer> list = new ArrayList();
list.remove(1);
list.remove(10);
```

å½“Listä¸­å­˜æ”¾çš„æ˜¯intæ—¶ï¼Œremoveæ–¹æ³•å°†æ— æ³•åˆ é™¤å¯¹åº”çš„å…ƒç´ ï¼Œä¼šé»˜è®¤çš„è°ƒç”¨åˆ é™¤ç´¢å¼•çš„é‡è½½æ–¹æ³•ã€‚

æ‰€ä»¥å¼€å‘ä¸­åº”è¯¥å°½é‡é¿å…ä¸å¿…è¦çš„æ–¹æ³•é‡è½½



### æ‰©å±•æˆå‘˜

å°±æ˜¯ç»™ç°æœ‰çš„ç±»æ·»åŠ æ–¹æ³•ï¼Œå±æ€§ã€‚æœ‰äº†è¿™ä¸ªç‰¹æ€§é‚£äº›StringUtilså°±å¯ä»¥ä¸ç”¨äº†ã€‚

```java
fun String.test(){
    println("è°ƒç”¨äº†a")
}

fun main(args: Array<String>) {

    "test".test()
}
```

è¿™æ®µä»£ç ç›´æ¥å®šä¹‰äº†ä¸€ä¸ªStringçš„æ‰©å±•æ–¹æ³• testã€‚åœ¨mainæ–¹æ³•ä¸­å¯ä»¥ç›´æ¥ç”¨stringè°ƒç”¨testæ–¹æ³•



### å±æ€§ä»£ç†

kotlinçš„ä»£ç†æ¨¡å¼éœ€è¦å®ç°ä¸€ä¸ªæ¥å£ï¼Œè€Œå±æ€§ä»£ç†åªéœ€è¦å®ç°getValueå’ŒsetValueæ–¹æ³•å³å¯ã€‚

ä¾‹ï¼š

~~~java
//ä½¿ç”¨byå…³é”®å­— lazyä»£ç†äº†s1çš„å€¼
val s1:String by lazy {
    "s1"
}
~~~





### æ•°æ®ç±»

ä½¿ç”¨dataå…³é”®å­—ä¿®é¥°ç±»ï¼Œè¯¥ç±»ä¼šè‡ªåŠ¨ç”Ÿæˆ

~~~java
equals()
hashCode()
toString()
componentN()
copy()
~~~

data calssè¢«ç¼–è¯‘å™¨ç¼–è¯‘åæ˜¯final å¹¶ä¸”æ²¡æœ‰æ— å‚æ„é€ ï¼Œå¯ä»¥é€šè¿‡å®˜æ–¹çš„æ’ä»¶æ¥è§£å†³ï¼ˆ`noarg`ã€`allopen`ï¼‰

ä½†æ˜¯æ’ä»¶éƒ½æ˜¯åœ¨ç¼–è¯‘åä¿®æ”¹å­—èŠ‚ç æ–‡ä»¶ï¼Œåœ¨ä½¿ç”¨æ—¶ä¾ç„¶æ— æ³•é€šè¿‡æ— å‚æ„é€ ã€‚

ç›®å‰æ„Ÿè§‰è¿™ä¸œè¥¿æ²¡ä»€ä¹ˆåµç”¨ã€‚

[noargã€allopenæ’ä»¶çš„ä½¿ç”¨](https://www.jianshu.com/p/90a3233b0a8a?utm_campaign=maleskine&utm_content=note&utm_medium=reader_share&utm_source=weibo)



### å†…éƒ¨ç±»(this@Outter,this@Inner)

**å†…éƒ¨ç±»å°±æ˜¯å®šä¹‰åœ¨ç±»å†…éƒ¨çš„ç±»ï¼Œå’Œjavaä¸€æ ·**

**kotliné»˜è®¤æ˜¯é™æ€å†…éƒ¨ç±»ï¼Œjavaé»˜è®¤æ˜¯éé™æ€çš„**

**éé™æ€å†…éƒ¨ç±»ä½¿ç”¨innerå…³é”®å­—**

**åŒä¸€ä¸ªå±æ€§åå¯ä»¥ä½¿ç”¨this@Outterå’Œthis@InneråŒºåˆ†**

**é™æ€å†…éƒ¨ç±»å¯ä»¥è°ƒç”¨å¤–éƒ¨é™æ€æˆå‘˜ï¼Œéé™æ€çš„éœ€è¦å®ä¾‹åŒ–å¤–éƒ¨ç±»æ‰èƒ½è®¿é—®**

**kotlinä¸­çš„åŒ¿åå†…éƒ¨ç±»å¯ä»¥ç»§æ‰¿å…¶ä»–ç±»**



åŒ¿åå†…éƒ¨ç±»å†™æ³•

~~~java
   object : View.OnClickListener {
        override fun onClick(view: View?) {
        }

    }
//ç›¸å½“äº
        new View.OnClickListener(){
            @Override
            public void onClick(View view) {

            }
        };
~~~



### æšä¸¾(enum)

æšä¸¾å°±æ˜¯å®ä¾‹å›ºå®šçš„ç±»ï¼Œä½¿ç”¨enumä¿®é¥°ç±»ã€‚

æœ¬è´¨å…¶å®æ˜¯ç§æœ‰äº†æ„é€ ï¼ˆæ„é€ æ–¹æ³•æ˜¯protectedçš„ï¼‰çš„finalç±»ï¼Œåœ¨åˆå§‹åŒ–çš„æ—¶å€™ç”Ÿæˆäº†å›ºå®šæ•°é‡çš„ç¤ºä¾‹ã€‚

~~~java
enum class LogLevel(){
    VERBOSE(), DEBUG(), INFO(), WARN(), ERROR(), ASSERT();
}
~~~

ä¸Šä¾‹åªèƒ½æœ‰6ä¸ªå®ä¾‹ï¼Œå’Œæ™®é€šç±»ä¸€æ ·å¯ä»¥æœ‰æ„é€ ï¼Œä¹Ÿå¯ä»¥æœ‰æ™®é€šæ–¹æ³•



### å¯†å°ç±»(sealed Class)

å¯†å°ç±»æ˜¯å­ç±»å›ºå®šçš„ç±»ï¼Œä½¿ç”¨sealedä¿®é¥°

å’Œæšä¸¾çš„åŒºåˆ«æ˜¯ï¼šæšä¸¾å®ä¾‹å›ºå®šï¼Œå¯†å°ç±»æ˜¯å­ç±»å¯æ•°ã€‚

å¯†å°ç±»å’Œå­ç±»å¿…é¡»å†™åœ¨åŒä¸€ä¸ªæ–‡ä»¶

å¯†å°ç±»æœ¬èº«æ˜¯æŠ½è±¡çš„ï¼Œä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ï¼Œæ„é€ å‡½æ•°é»˜è®¤æ˜¯private





## é«˜é˜¶å‡½æ•°

### é«˜é˜¶å‡½æ•°çš„åŸºæœ¬æ¦‚å¿µ

ä»¥å‡½æ•°ä½œä¸ºå‚æ•°æˆ–è¿”å›å‡½æ•°çš„å‡½æ•°è¢«ç§°ä¸ºé«˜é˜¶å‡½æ•°



**å‡½æ•°å¼•ç”¨**

åŒå†’å·æ“ä½œç¬¦ è¡¨ç¤ºæŠŠä¸€ä¸ªæ–¹æ³•å½“åšä¸€ä¸ªå‚æ•°ï¼Œä¼ é€’åˆ°å¦ä¸€ä¸ªæ–¹æ³•ä¸­è¿›è¡Œä½¿ç”¨ï¼Œé€šä¿—çš„æ¥è®²å°±æ˜¯å¼•ç”¨ä¸€ä¸ªæ–¹æ³•

~~~java
 args.forEach { println(it) }
~~~

æ­¤æ®µä»£ç å¯ä»¥å†™æˆ

~~~java
  args.forEach(::println)
~~~

è¿™é‡Œå› ä¸ºforEachæ¥å—çš„å‚æ•°å’Œprintln() æ¥å—çš„å‚æ•°ä¸€è‡´ï¼Œç›´æ¥ç®€å†™æˆå‡½æ•°å¼•ç”¨çš„æ–¹å¼

è¿™é‡Œçš„printlnéœ€è¦çš„å‚æ•°ä¼šç”±forEachç›´æ¥ä¼ å…¥ï¼Œå°±å½“æˆæ˜¯ä¸€ç§å›ºå®šå†™æ³•

è¿™é‡Œçš„printlnæ˜¯åŒ…çº§å‡½æ•° ä¸éœ€è¦ä»»ä½•å¯¹è±¡å¯ä»¥ç›´æ¥è°ƒç”¨ 

~~~java
fun main(args: Array<String>) {

    args.forEach(::println)

    val helloWorld = Hello::world
    
}

class Hello {

    fun world() {
        println("Hello World")

    }
}
~~~

ä»¥ä¸Šå®šä¹‰äº†ç±» Hello å‡½æ•°world ï¼Œé‚£å°±å¯ä»¥é€šè¿‡ç±»å::å‡½æ•°å æ‹¿åˆ°å‡½æ•°å¼•ç”¨ï¼Œæ³¨æ„ è¿™æ—¶å€™æœ‰äº†å‡½æ•°å¼•ç”¨å¹¶æ²¡æœ‰çœŸæ­£æ‰§è¡Œ

å¦‚æœè¦æ‰§è¡Œå‡½æ•°çš„è¯

~~~java
    val helloWorld = Hello::world
    val hello  = Hello()
    helloWorld(hello)
~~~

è¿™ç§ç±»æ–¹æ³•å…¶å®æœ‰ä¸ªéšè—å‚æ•°å°±æ˜¯æ‰€åœ¨ç±»çš„æœ¬èº«

~~~java
    args.filter (String::isNotEmpty)
~~~

è¿™é‡ŒisNotEmptyæ˜¯Stringæ‰©å±•æ–¹æ³•ï¼Œè¿™ä¸ªå’Œåˆšæ‰é‚£ä¸ªå·®ä¸å¤šï¼ŒisNotEmptyæ‰©å±•æ–¹æ³•æ˜¯æ²¡æœ‰å‚æ•°çš„ï¼Œä½†æ˜¯éœ€è¦ç”¨Stringæ¥è°ƒç”¨ã€‚ç›¸å½“äºisNotEmptyéœ€è¦ä¸€ä¸ªéšè—å‚æ•°ã€‚

ä¸‰ç§å¼•ç”¨æ–¹å¼

~~~java
fun main(args: Array<String>) {

    //åŒ…çº§å‡½æ•°
    args.forEach(::println)
    //æ‰©å±•å‡½æ•°
    args.filter(String::isNotEmpty)
    //æ™®é€šç±»å‡½æ•°
    val hello = Hello()
    args.forEach(hello::world)
}

class Hello {
    fun world(any: Any) {
        println("Hello World")

    }
}
~~~



### å¸¸è§é«˜é˜¶å‡½æ•°

~~~kotlin
/**
 * map:
 * å°†Listä¸­æ¯ä¸ªå…ƒç´ è½¬æ¢æˆæ–°çš„å…ƒç´ ,å¹¶æ·»åŠ åˆ°ä¸€ä¸ªæ–°çš„Listä¸­,æœ€åå°†æ–°Listè¿”å›
 * éå†listä¸­çš„å…ƒç´ å¹¶æ‰§è¡Œç»™å®šçš„è¡¨è¾¾å¼ï¼Œå¹¶æ·»åŠ åˆ°æ–°çš„listä¸­
 */
fun mapTest() {

    val list = arrayListOf(1, 2, 3)
    val newArray = list.map { i: Int ->
        i + 1
    }
    newArray.forEach(::println)
    //å°†listä¸­çš„å…ƒç´ æ¯ä¸ªéƒ½+1
    //è¾“å‡º 2ï¼Œ3ï¼Œ4
}

/**
 * flatMapï¼š
 * éå†æ¯ä¸ªå…ƒç´ ï¼Œå¹¶ä¸ºæ¯ä¸ªå…ƒç´ åˆ›å»ºæ–°çš„é›†åˆï¼Œæœ€ååˆå¹¶åˆ°ä¸€ä¸ªé›†åˆä¸­
 */
fun flatMapTest() {

    val list1 = listOf(1, 2)
    val list2 = listOf(3, 4)
    val list = listOf(list1, list2)
    val flatMap1 = list.flatMap {
        it.asIterable()
    }

    flatMap1.forEach(::println)
    //æ‹¼æ¥list1 å’Œ list2
    //è¾“å‡º 1ï¼Œ2ï¼Œ3ï¼Œ4
}

/**
 *  reduceï¼šç´¯è®¡è®¡ç®—ç»“æœ
 *  å‡½æ•°ç»™å®šä¸¤ä¸ªå‚æ•° accï¼šä¸Šä¸€æ¬¡è®¡ç®—çš„è®°è¿‡ iï¼šæœ¬æ¬¡å‚ä¸è¿ç®—çš„å…ƒç´ 
 *
 */
fun reduceTest() {

    val list = arrayOf(1, 2, 3)
    val result1 = list.reduce { acc, i -> acc + i }
    val result2 = list.reduce { acc, i -> acc * i }
    println(result1)
    //è®¡ç®— 1+2+3 = 6
    println(result2)
    //è®¡ç®— 1*2*3 = 6
}

/**
 * foldï¼šå’Œreduceç±»ä¼¼ ä½†æ˜¯å¯ä»¥è®¾ç½®åˆå§‹å€¼
 */
fun foldTest() {

    val list = arrayOf(1, 2, 3)
    val result1 = list.fold(10, { a, b -> a + b })
    val result2 = list.fold(10, { a, b -> a * b })
    println(result1)
    //è®¡ç®— 10+1+2+3 = 16
    println(result2)
    //è®¡ç®— 10*1*2*3 = 60
}

/**
 * joinToString :æ‹¼æ¥å­—ç¬¦ä¸²
 * separatorï¼šåˆ†éš”ç¬¦
 * prefixï¼šå­—ç¬¦ä¸²å‰ç¼€
 * postfixï¼šå­—ç¬¦ä¸²åç¼€
 * limitï¼šæˆªå–å‡ ä¸ªå…ƒç´  åé¢ç”¨çœç•¥å·ä»£æ›¿
 * truncatedï¼šå’Œlimité…åˆä½¿ç”¨ æ›¿ä»£çœç•¥å·ç¬¦å·
 */
fun joinToStringTest() {

    val list = arrayOf(1, 2, 3)
    val string1 = list.joinToString()
    val string2 = list.joinToString(
        limit = 2,
        truncated = "çœç•¥å·",
        separator = "ã€‚",
        prefix = "å‰ç¼€",
        postfix = "åç¼€"

    )
    println(string1)
    println(string2)
}

/**
 * filter:è¿‡æ»¤list å¹¶è¿”å›ä¸€ä¸ªæ–°çš„list
 */
fun filterTest() {

    val list = arrayListOf(1, 2, 3)
    val result = list.filter { it > 1 }
    result.forEach(::println)
    //è¿‡æ»¤å°äº1çš„å…ƒç´ 
}

/**
 * takeWhile:éå†listä¸­çš„å…ƒç´ ,å°†ç¬¦åˆè¦æ±‚çš„å…ƒç´ æ·»åŠ åˆ°æ–°é›†åˆä¸­
 * ä¸€æ—¦é‡åˆ°ä¸ç¬¦åˆè¦æ±‚çš„,ç›´æ¥ç»ˆæ­¢
 */
fun takeWhileTest() {

//æ³¨æ„:è¿”å›çš„é›†åˆä¸­åªæœ‰4å’Œ3,æ²¡æœ‰5,å› ä¸ºé‡åˆ°2æ—¶,ä¸ç¬¦åˆè¦æ±‚,ç¨‹åºç›´æ¥ç»ˆæ­¢
    arrayOf(4, 3, 2, 5).takeWhile { i -> i > 2 }.forEach(::println)

    val list = arrayOf(4, 3, 2, 5)
    val result = list.takeWhile { it < 2 }
    result.forEach(::println)
    //è¿‡æ»¤å°äº2çš„å…ƒç´ å¹¶åœ¨é‡åˆ°ä¸ç¬¦åˆæ¡ä»¶çš„å…ƒç´ æ—¶ç›´æ¥è·³å‡º
}
~~~







~~~kotlin
/**
 * map å‡½æ•°
 * å‚æ•°æ¥æ”¶ä¸€ä¸ª(T) -> Rçš„è¡¨è¾¾å¼ T R å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼Œä¸¤ä¸ªç±»å‹ä¹Ÿå¯ä»¥æ˜¯ä¸€æ ·çš„
 * åŠŸèƒ½ï¼šéå†ä¸€ä¸ªArrayï¼Œæ¯æ¬¡å¾ªç¯éå†çš„æ—¶å€™æ‰§è¡Œå‚æ•°ä¸­çš„è¡¨è¾¾å¼å¹¶å°†è¿”å›å€¼å­˜å‚¨åˆ°å¦ä¸€ä¸ªListä¸­ï¼Œæœ€ç»ˆè¿”å›è¿™ä¸ªlist
 */
fun mapTest() {

    val ints = arrayOf(1, 2, 3, 4, 5)
    //æœ€åŸå§‹çš„å†™æ³•
    val list1 = ints.map(
        fun(i: Int): Int {
            return i
        }
    )
    //lambdaè¡¨è¾¾å¼å†™æ³•
    val list2 = ints.map(
        { i: Int -> i }
    )
    //æœ€ç»ˆç®€åŒ–åçš„å†™æ³•
    val list3 = ints.map { it }
}


/**
 * flatMap å‡½æ•°
 * å‚æ•°æ¥æ”¶ transform: (T) -> Iterable<R>  Iterable(å¯éå†)
 * éå†æ¯ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶æ·»åŠ åˆ°ä¸€ä¸ªæ€»é›†åˆä¸­
 */
fun flatMapTest() {

    val intRanges = listOf(1..10, 2..5, 10..15)
    //æœ€åŸå§‹çš„å†™æ³•
    intRanges.flatMap(
        fun(intRange: IntRange): IntRange {
            return intRange
        }
    )

    //lambdaè¡¨è¾¾å¼å†™æ³•
    intRanges.flatMap(
        { intRange: IntRange -> intRange }
    )
    //æœ€ç»ˆç®€åŒ–åçš„å†™æ³•
    intRanges.flatMap { it }


    //éå†é€”ä¸­æ“ä½œä¸€äº›æ•°æ®
    intRanges.flatMap { intRange ->
        intRange.map { int ->
            "NO:$int"
        }
    }
    //ä»¥ä¸Šçš„intRangeå’Œintéƒ½å¯ä»¥ç”¨itä»£æ›¿ï¼Œä¸ºäº†ä¿è¯é˜…è¯»æ€§æœ€å¥½è¿˜æ˜¯å†™å‡ºä»–ä»¬çš„ç¤ºä¾‹
}

/**
 * reduce å‡½æ•°
 * å‚æ•°æ¥æ”¶ä¸€ä¸ª operation: (acc: S, T) -> Sçš„è¡¨è¾¾å¼  Sæ˜¯accçš„ç±»å‹
 * operationå³ -> S çš„å®ç° å¯ä»¥ç›¸åŠ  å¯ä»¥ç›¸ä¹˜
 * åŠŸèƒ½ï¼šéå†ä¸€ä¸ªArrayï¼Œæ±‚å’Œ
 */
fun reduceTest() {

    //operation: (acc: S, T) -> S
    val ints = arrayOf(1, 2, 3)

    val reduce = ints.reduce { acc, i -> acc + i }
    println(reduce)
    
    //é˜¶ä¹˜ç¤ºä¾‹
    val i = 6
    val factorial = (1..i).reduce { acc, i -> acc * i }
}
~~~



### letã€withã€runã€applyã€alsoå‡½æ•°çš„ä½¿ç”¨

**let**

letæ˜¯ä¸€ä¸ªä½œç”¨åŸŸå‡½æ•°ï¼Œå½“ä½ éœ€è¦å»å®šä¹‰ä¸€ä¸ªå˜é‡åœ¨ä¸€ä¸ªç‰¹å®šçš„ä½œç”¨åŸŸèŒƒå›´å†…ï¼Œå¯ä»¥ç”¨åˆ°letï¼›letå‡½æ•°å¦ä¸€ä¸ªä½œç”¨å°±æ˜¯å¯ä»¥é¿å…å†™ä¸€äº›åˆ¤æ–­nullçš„æ“ä½œã€‚

~~~kotlin
        var s :String?= null     
        s?.let { 
            //énull
        }
~~~

**with**

wihtå¹¶ä¸æ˜¯æ‰©å±•å‡½æ•°çš„å½¢å¼å­˜åœ¨ï¼Œå®ƒéœ€è¦å°†å¯¹è±¡å½“åšå‚æ•°ã€‚  ä½¿ç”¨ä¸€èˆ¬æ˜¯è¿™æ ·

~~~kotlin
            with(s){
                log(length)
            }
~~~

è¡¨ç¤ºåœ¨å¤§æ‹¬å·å†…ç›¸å½“äºåœ¨sçš„ç±»é‡Œï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨å®ƒçš„å‡½æ•°ã€‚

**run**

runç›¸å½“äºletå’Œwithçš„åˆä½“

~~~kotlin
    val run: Unit? = s?.run {
        log(length)
    }
~~~

runä¼šè¿”å›è¿™ä¸ªè¡¨è¾¾å¼çš„ç»“æœ

**apply**

applyçš„åŠŸèƒ½å’Œrunå·®ä¸å¤šï¼Œä¸åŒçš„æ˜¯applyè¿”å›å€¼æ˜¯è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æœ¬èº«ã€‚runè¿”å›çš„æ˜¯è¡¨è¾¾å¼æœ€åä¸€è¡Œçš„å€¼ã€‚

~~~kotlin
    val apply: String? = s?.apply {
        log(length)
    }
~~~

**also**

alsoå’Œletå·®ä¸å¤šï¼Œletè¿”å›çš„æ˜¯æ˜¯è¡¨è¾¾å¼æœ€åä¸€è¡Œçš„å€¼ï¼Œalsoè¿”å›å€¼æ˜¯è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æœ¬èº«



[Kotlinç³»åˆ—ä¹‹letã€withã€runã€applyã€alsoå‡½æ•°çš„ä½¿ç”¨](https://blog.csdn.net/u013064109/article/details/78786646#6)





### é—­åŒ…

åœ¨ä¸€ä¸ªå‡½æ•°Aä¸­è¿”å›äº†å¦ä¸€ä¸ªå‡½æ•°B,åªæœ‰å‡½æ•°Bæ‰å¯ä»¥è®¿é—®å‡½æ•°Aä¸­çš„å†…å®¹,è¿™ä¸ªç°è±¡çš„æ¦‚å¿µå«åšé—­åŒ…

javaä¸­å‡½æ•°æ˜¯æ²¡æœ‰çŠ¶æ€çš„ï¼Œè°ƒç”¨å®Œæ¯•åï¼Œé‡Œé¢çš„æ•°æ®ä¼šè¢«å›æ”¶ï¼Œä¸ä¼šè¢«ä¿å­˜ã€‚åœ¨javaå‡½æ•°ä¸­ä¹Ÿæ— æ³•åœ¨å£°æ˜å…¶ä»–å‡½æ•°ï¼Œæ‰€ä»¥javaä¸­æ˜¯æ²¡æœ‰é—­åŒ…çš„

~~~java
fun addFun(x: Int): (Int) -> Int {
    return fun(y: Int): Int {
        return x + y;
    }
}
~~~

ä»¥ä¸Šä»£ç å®šä¹‰äº†ä¸€ä¸ªaddFunå‡½æ•°ï¼Œè¿”å›å€¼æ˜¯ä¸€ä¸ª(Int) -> Intçš„å‡½æ•°ï¼Œå‡½æ•°çš„å®ç°ç›´æ¥è¿”å›äº†ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œå°†ä¸¤ä¸ªå€¼ç›¸åŠ å¹¶è¿”å›ï¼ˆè¿™ä¸ªåŒ¿åå‡½æ•°æ­£æ˜¯addå‡½æ•°çš„è¿”å›å€¼ï¼‰

~~~java
    val add = addFun(1)
    println( add(1))
~~~

ç¬¬ä¸€æ¬¡è°ƒç”¨addFunå‡½æ•°ä¼ å…¥xçš„å€¼å¹¶è·å–åŒ¿åå‡½æ•°çš„å¼•ç”¨ï¼Œç¬¬äºŒæ¬¡è°ƒç”¨ä¼ å…¥yçš„å€¼è¿”å›x+yçš„å€¼

ä¾‹2

æ™®é€šå‡½æ•°ä¸æºå¸¦çŠ¶æ€ï¼Œè°ƒç”¨å®Œæ¯•åé‡Œé¢æ‰€æœ‰çš„å†…å®¹å°±ä¼šè¢«é‡Šæ”¾æ‰ã€‚

~~~java
fun main(args: Array<String>) {    
    test()
}
fun test(){
    var a=3
    println(a);
}
~~~

è¿™æ®µä»£ç æ— è®ºæ‰§è¡Œå¤šå°‘æ¬¡éƒ½ä¼šè¾“å…¥3

```java
fun main(args: Array<String>) {
    val add = addTest()
    println(add())
    println(add())   
}

fun addTest(): () -> Int {
    var i = 1;
    return fun(): Int {
        return i++
    }
}
```

ä»¥ä¸Šæ–¹æ³•æ‹†åˆ†å¼€å…¶å®é¦–å…ˆå…ˆè·å–addTest()çš„å®ä¾‹ï¼Œæ­¤æ—¶å¹¶æ²¡æœ‰çœŸæ­£æ‰§è¡Œæ–¹æ³•ï¼Œ` println(add())`è°ƒç”¨addå…¶å®æ˜¯è°ƒç”¨addTest()çš„åŒ¿åæ–¹æ³•ã€‚æ­¤æ–¹æ³•ä¿å­˜äº†içš„å€¼ï¼Œæ‰€ä»¥æ¯æ¬¡è°ƒç”¨add()içš„å€¼éƒ½ä¼šå‘ç”Ÿå˜åŒ–

~~~java
fun test(x: Int): (y: Int) -> Int {
    return fun(y: Int): Int {
        return x+y
    }
}

fun test(x: Int) = fun (y: Int) = x+y
~~~

è¿™æ®µä»£ç ä¸­çš„ä¸¤ä¸ªtestå‡½æ•° æ˜¯ä¸€æ ·çš„

**é—­åŒ…çš„æ€»ç»“**

å‡½æ•°é‡Œé¢å£°æ˜å‡½æ•°ï¼Œå‡½æ•°é‡Œé¢è¿”å›å‡½æ•°ï¼Œå°±æ˜¯é—­åŒ…ã€‚é—­åŒ…å‡½æ•°çš„å˜é‡åœ¨æ‰§è¡Œå®Œåä»ä¸ä¼šè¢«é‡Šæ”¾



## åç¨‹

[åç¨‹å…¥é—¨]([https://github.com/yeqiu/SwissArmyKnife/blob/master/kotlin/2019-09-20-kotlin%E7%9A%84%E5%8D%8F%E7%A8%8B%E5%85%A5%E9%97%A8.md](https://github.com/yeqiu/SwissArmyKnife/blob/master/kotlin/2019-09-20-kotlinçš„åç¨‹å…¥é—¨.md))

[åç¨‹è¿›é˜¶]([https://github.com/yeqiu/SwissArmyKnife/blob/master/kotlin/2019-10-18-%E5%8D%8F%E7%A8%8B%E7%9A%84%E8%BF%9B%E9%98%B6.md](https://github.com/yeqiu/SwissArmyKnife/blob/master/kotlin/2019-10-18-åç¨‹çš„è¿›é˜¶.md))



## åå°„è¯­æ³•ä¸åº“

**JAVAåå°„æœºåˆ¶æ˜¯åœ¨è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»ï¼Œéƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»çš„æ‰€æœ‰å±æ€§å’Œæ–¹æ³•ï¼›å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„æ–¹æ³•å’Œå±æ€§ï¼›è¿™ç§åŠ¨æ€è·å–ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡æ–¹æ³•çš„åŠŸèƒ½ç§°ä¸ºjavaè¯­è¨€çš„åå°„æœºåˆ¶ã€‚**



### Kotlinä¸­ä½¿ç”¨ Java åå°„

java çš„åå°„å§‹ç»ˆè¦è·å–åˆ°ç±»çš„classï¼Œä¸€èˆ¬æœ‰ä¸¤ç§æ–¹æ³•

~~~kotlin
    val clazz = Person::class.java
		//é€šè¿‡å¯¹è±¡è·å–
    val person = Person("å°å·å­", 18)
    val clazz2 = person.javaClass
~~~

**åˆ›å»ºå¯¹è±¡**

~~~kotlin
    //åˆ›å»ºå¯¹è±¡ æ— å‚æ„é€  å¦‚å®é™…æ²¡æœ‰æ— å‚æ„é€ ä¼šå¼‚å¸¸
    val person1 = clazz.newInstance()
    //æœ‰å‚æ„é€ 
    val person2 = clazz.getDeclaredConstructor(String::class.java, Int::class.java).newInstance("å°å·å­", 18)

~~~

**è®¿é—®æˆå‘˜**

~~~kotlin
    //è®¿é—®æˆå‘˜ isAccessible = trueå¯ä»¥çªç ´privateçš„é™åˆ¶
    val name = clazz.getDeclaredField("name").apply { isAccessible = true }.get(person2)
    println(name)
    
    //è°ƒç”¨å‡½æ•° æ— å‚ invokeçš„å‚æ•°å°±æ˜¯åˆ›å»ºçš„å¯¹è±¡
    val name2 = clazz.getDeclaredMethod("getPersonName").apply { isAccessible = true }.invoke(person2)
    println(name2)
    //è°ƒç”¨å‡½æ•° æœ‰å‚ invokeçš„å‚æ•°å°±æ˜¯åˆ›å»ºçš„å¯¹è±¡å’Œå‡½æ•°çš„å‚æ•°
    clazz.getDeclaredMethod("setPersonName", String::class.java).apply { isAccessible = true }.invoke(person2, "å°å·å­2")
    println(person2)
~~~

**javaä¸­çš„findæˆ–è€…kotlinä¸­çš„valï¼Œéƒ½æ˜¯å¯ä»¥é€šè¿‡åå°„ä¿®æ”¹å­—æ®µçš„å€¼ï¼ŒgetDeclaredMethod()å¯ä»¥æ— è§†è®¿é—®æƒé™ç›´æ¥è·å–æˆå‘˜**

### kotlinåå°„

kotlinåå°„éœ€è¦å•ç‹¬æ·»åŠ ä¾èµ–

~~~kotlin
 compile "org.jetbrains.kotlin:kotlin-reflect:$kotlin_version"
~~~

kotlinçš„åå°„è¿˜å¾ˆä¸å®Œå–„ï¼Œè€Œä¸”æ•ˆç‡è¦è¿œè¿œä½äºjavaã€‚å¹¶ä¸æ¨èä½¿ç”¨kotlinçš„åå°„ã€‚



## æ³›å‹ï¼Œå‹å˜

[æµ…è°ˆjavaçš„æ³›å‹]([https://github.com/yeqiu/SwissArmyKnife/blob/master/java/2019-09-05-%E6%B5%85%E8%B0%88java%E7%9A%84%E6%B3%9B%E5%9E%8B.md](https://github.com/yeqiu/SwissArmyKnife/blob/master/java/2019-09-05-æµ…è°ˆjavaçš„æ³›å‹.md))



## Kotlinä¸ Java æ··åˆå¼€å‘

### SAM è½¬æ¢

javaä¸­åªæœ‰æ¥å£åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•å°±å¯ä»¥ä½¿ç”¨lambadè¡¨è¾¾å¼ç›´æ¥æ›¿ä»£ã€‚

~~~kotlin
    Thread(object : Runnable {
        override fun run() {
            log("Runnable")
        }
    }).start()

//ä¸Šé¢çš„Runnableæ¥å£å¯ä»¥ç›´æ¥ä½¿ç”¨lambadæ›¿ä»£
    Thread {
        log("Runnable")
    }.start()
~~~

**SAMåªæ”¯æŒjavaæ¥å£ï¼Œå¹¶ä¸æ”¯æŒkotlin**

å¦‚æœkotlinä¸­è¦ä½¿ç”¨çš„è¯ï¼Œéœ€è¦åœ¨æ–‡ä»¶ä¸­å£°æ˜ `typealias Runnable = ()->Unit`è¡¨ç¤ºRunnable å°±æ˜¯è¿™æ ·çš„ä¸€ä¸ªè¡¨è¾¾å¼ã€‚æ‰ç”¨å¤„å°±å¯ä»¥ç›´æ¥ä½¿ç”¨lambadè¡¨è¾¾å¼ã€‚









[forEach è·³å‡ºçš„é—®é¢˜](https://coding.imooc.com/learn/questiondetail/108331.html)

é—­åŒ…ä»€ä¹ˆæ—¶å€™é‡Šæ”¾,é—­åŒ…å¦‚ä½•ç›´æ¥returnä¸»å‡½æ•°







